2025-12-03 00:11:29,502 [DEBUG] selector_events.py:64 - Using selector: KqueueSelector
2025-12-03 00:11:29,502 [INFO] main.py:10 - Started
2025-12-03 00:11:29,502 [INFO] mcp_server.py:135 - Starting MCP Database Server...
2025-12-03 00:11:29,502 [DEBUG] server.py:157 - Initializing server 'DBMCPServer ðŸš€'
2025-12-03 00:11:29,502 [DEBUG] server.py:414 - Registering handler for ListToolsRequest
2025-12-03 00:11:29,502 [DEBUG] server.py:281 - Registering handler for ListResourcesRequest
2025-12-03 00:11:29,502 [DEBUG] server.py:301 - Registering handler for ListResourceTemplatesRequest
2025-12-03 00:11:29,502 [DEBUG] server.py:243 - Registering handler for PromptListRequest
2025-12-03 00:11:29,502 [DEBUG] server.py:486 - Registering handler for CallToolRequest
2025-12-03 00:11:29,502 [DEBUG] server.py:316 - Registering handler for ReadResourceRequest
2025-12-03 00:11:29,502 [DEBUG] server.py:265 - Registering handler for GetPromptRequest
2025-12-03 00:11:29,509 [INFO] factory.py:76 - All fetchers initialized
2025-12-03 00:11:29,539 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 5
2025-12-03 00:11:29,568 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 13
2025-12-03 00:11:29,568 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 14
2025-12-03 00:11:29,573 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdarmutlu@localhost:5432/omdb [id=5]
2025-12-03 00:11:29,576 [INFO] postgresql_manager.py:39 - 5 is activated
2025-12-03 00:11:29,600 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: postgres@pg1:5432/demo [id=13]
2025-12-03 00:11:29,601 [INFO] postgresql_manager.py:39 - 13 is activated
2025-12-03 00:11:29,602 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdar@pg2:5432/Adventureworks [id=14]
2025-12-03 00:11:29,603 [INFO] postgresql_manager.py:39 - 14 is activated
2025-12-03 00:11:29,603 [INFO] postgresql_manager.py:66 - âœ… DB Manager initialized. Active pools: 3
2025-12-03 00:11:29,603 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 00:11:29,622 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 00:11:29,622 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:11:29,623 [DEBUG] _trace.py:87 - connect_tcp.failed exception=ConnectError(OSError('All connection attempts failed'))
2025-12-03 00:22:14,942 [DEBUG] selector_events.py:64 - Using selector: KqueueSelector
2025-12-03 00:22:14,942 [INFO] main.py:10 - Started
2025-12-03 00:22:14,942 [INFO] mcp_server.py:155 - Starting MCP Database Server...
2025-12-03 00:22:14,943 [DEBUG] server.py:157 - Initializing server 'DBMCPServer ðŸš€'
2025-12-03 00:22:14,943 [DEBUG] server.py:414 - Registering handler for ListToolsRequest
2025-12-03 00:22:14,943 [DEBUG] server.py:281 - Registering handler for ListResourcesRequest
2025-12-03 00:22:14,943 [DEBUG] server.py:301 - Registering handler for ListResourceTemplatesRequest
2025-12-03 00:22:14,943 [DEBUG] server.py:243 - Registering handler for PromptListRequest
2025-12-03 00:22:14,943 [DEBUG] server.py:486 - Registering handler for CallToolRequest
2025-12-03 00:22:14,943 [DEBUG] server.py:316 - Registering handler for ReadResourceRequest
2025-12-03 00:22:14,943 [DEBUG] server.py:265 - Registering handler for GetPromptRequest
2025-12-03 00:22:14,949 [INFO] factory.py:76 - All fetchers initialized
2025-12-03 00:22:14,978 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 5
2025-12-03 00:22:15,008 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 14
2025-12-03 00:22:15,008 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 13
2025-12-03 00:22:15,011 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdarmutlu@localhost:5432/omdb [id=5]
2025-12-03 00:22:15,013 [INFO] postgresql_manager.py:39 - 5 is activated
2025-12-03 00:22:15,027 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: postgres@pg1:5432/demo [id=13]
2025-12-03 00:22:15,028 [INFO] postgresql_manager.py:39 - 13 is activated
2025-12-03 00:22:15,044 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdar@pg2:5432/Adventureworks [id=14]
2025-12-03 00:22:15,045 [INFO] postgresql_manager.py:39 - 14 is activated
2025-12-03 00:22:15,045 [INFO] postgresql_manager.py:66 - âœ… DB Manager initialized. Active pools: 3
2025-12-03 00:22:15,046 [INFO] base.py:507 - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-12-03 00:22:15,046 [INFO] metadata_scheduler_manager.py:173 - Loaded job: Test2
2025-12-03 00:22:15,047 [INFO] base.py:1090 - Added job "SchedulerManager.execute_job" to job store "default"
2025-12-03 00:22:15,047 [INFO] base.py:214 - Scheduler started
2025-12-03 00:22:15,047 [INFO] metadata_scheduler_manager.py:178 - Scheduler started
2025-12-03 00:22:15,081 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:22:15,081 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:22:45.046892+03:00 (in 29.965354 seconds)
2025-12-03 00:22:15,081 [INFO] mcp_server.py:68 - Waiting for server to start before connecting client...
2025-12-03 00:22:15,081 [INFO] streamable_http_manager.py:110 - StreamableHTTP session manager started
2025-12-03 00:22:17,083 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 00:22:17,114 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 00:22:17,115 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:22:17,117 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ea8fcb0>
2025-12-03 00:22:17,117 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:22:17,117 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:22:17,117 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:22:17,117 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:22:17,117 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:22:17,118 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:22:17,119 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:22:17,119 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:22:17,121 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:22:17 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'422')])
2025-12-03 00:22:17,121 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:22:17,121 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:22:17,121 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:22:17,121 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:22:17,122 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:22:17,122 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 00:22:17,122 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 00:22:17,122 [INFO] mcp_server.py:79 - âœ… MCP Client connected successfully internally!
2025-12-03 00:22:17,122 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:22:17,122 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:22:17,122 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:22:17,123 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:22:17,123 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:22:17,123 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:22:17,123 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:22:17,123 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 21:22:17 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'0')])
2025-12-03 00:22:17,123 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 00:22:17,123 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 00:22:17,123 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:22:17,123 [DEBUG] session.py:426 - Read stream closed by client
2025-12-03 00:22:17,123 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:22:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:22:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:23:15.046892+03:00 (in 29.998489 seconds)
2025-12-03 00:22:45,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:23:15 +03)" (scheduled at 2025-12-03 00:22:45.046892+03:00)
2025-12-03 00:22:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:22:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 00:22:45,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:22:45,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb51d10>
2025-12-03 00:22:45,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:22:45,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:22:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:22:45,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:22:45,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:22:45,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:22:45,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:22:45,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:22:45,058 [DEBUG] server.py:456 - Tool cache miss for list-all-tables, refreshing cache
2025-12-03 00:22:45,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,061 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,094 [DEBUG] server.py:723 - Response sent
2025-12-03 00:22:45,095 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:22:45,095 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:22:45,096 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:22:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 00:22:45,097 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:22:45,097 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:22:45,097 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:22:45,097 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:22:45,097 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:22:45,099 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 00:22:45,099 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:22:45,100 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:22:45,100 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:22:45,100 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:22:45,100 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:22:45,100 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:22:45,101 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 00:22:45,101 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 00:22:45,102 [DEBUG] server.py:723 - Response sent
2025-12-03 00:22:45,102 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:22:45,103 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:22:45,104 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:22:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'3119')])
2025-12-03 00:22:45,104 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:22:45,104 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:22:45,104 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:22:45,104 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:22:45,104 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:22:45,106 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:23:15 +03)" executed successfully
2025-12-03 00:23:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:23:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:23:45.046892+03:00 (in 29.998271 seconds)
2025-12-03 00:23:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:23:45 +03)" (scheduled at 2025-12-03 00:23:15.046892+03:00)
2025-12-03 00:23:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:23:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 3}}, jsonrpc='2.0', id=3)
2025-12-03 00:23:15,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:23:15,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:23:15,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:23:15,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb52990>
2025-12-03 00:23:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:23:15,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:23:15,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:23:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:23:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:23:15,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:23:15,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:23:15,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:23:15,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:23:15,066 [DEBUG] server.py:723 - Response sent
2025-12-03 00:23:15,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:23:15,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:23:15,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:23:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 00:23:15,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:23:15,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:23:15,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:23:15,071 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:23:15,072 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:23:15,076 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:23:45 +03)" executed successfully
2025-12-03 00:23:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:23:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:24:15.046892+03:00 (in 29.998055 seconds)
2025-12-03 00:23:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:24:15 +03)" (scheduled at 2025-12-03 00:23:45.046892+03:00)
2025-12-03 00:23:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:23:45,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 4}}, jsonrpc='2.0', id=4)
2025-12-03 00:23:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:23:45,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:23:45,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:23:45,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb3e2c0>
2025-12-03 00:23:45,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:23:45,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:23:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:23:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:23:45,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:23:45,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:23:45,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:23:45,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:23:45,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:23:45,064 [DEBUG] server.py:723 - Response sent
2025-12-03 00:23:45,065 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:23:45,065 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:23:45,068 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:23:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 00:23:45,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:23:45,069 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:23:45,069 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:23:45,069 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:23:45,069 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:23:45,072 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:24:15 +03)" executed successfully
2025-12-03 00:24:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:24:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:24:45.046892+03:00 (in 29.998139 seconds)
2025-12-03 00:24:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:24:45 +03)" (scheduled at 2025-12-03 00:24:15.046892+03:00)
2025-12-03 00:24:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:24:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 5}}, jsonrpc='2.0', id=5)
2025-12-03 00:24:15,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:24:15,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:24:15,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:24:15,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb3f5c0>
2025-12-03 00:24:15,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:24:15,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:24:15,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:24:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:24:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:24:15,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:24:15,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:24:15,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:24:15,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:24:15,065 [DEBUG] server.py:723 - Response sent
2025-12-03 00:24:15,066 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:24:15,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:24:15,068 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:24:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 00:24:15,068 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:24:15,068 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:24:15,069 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:24:15,069 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:24:15,069 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:24:15,072 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:24:45 +03)" executed successfully
2025-12-03 00:24:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:24:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:25:15.046892+03:00 (in 29.998839 seconds)
2025-12-03 00:24:45,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:25:15 +03)" (scheduled at 2025-12-03 00:24:45.046892+03:00)
2025-12-03 00:24:45,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:24:45,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 6}}, jsonrpc='2.0', id=6)
2025-12-03 00:24:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:24:45,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:24:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:24:45,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb32330>
2025-12-03 00:24:45,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:24:45,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:24:45,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:24:45,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:24:45,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:24:45,059 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:24:45,060 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:24:45,060 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:24:45,061 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:24:45,069 [DEBUG] server.py:723 - Response sent
2025-12-03 00:24:45,070 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:24:45,070 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:24:45,072 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:24:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 00:24:45,072 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:24:45,073 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:24:45,073 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:24:45,073 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:24:45,073 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:24:45,077 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:25:15 +03)" executed successfully
2025-12-03 00:25:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:25:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:25:45.046892+03:00 (in 29.997835 seconds)
2025-12-03 00:25:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:25:45 +03)" (scheduled at 2025-12-03 00:25:15.046892+03:00)
2025-12-03 00:25:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:25:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 7}}, jsonrpc='2.0', id=7)
2025-12-03 00:25:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:25:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:25:15,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:25:15,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ead39b0>
2025-12-03 00:25:15,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:25:15,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:25:15,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:25:15,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:25:15,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:25:15,058 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:25:15,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:25:15,060 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:25:15,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:25:15,066 [DEBUG] server.py:723 - Response sent
2025-12-03 00:25:15,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:25:15,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:25:15,069 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:25:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 00:25:15,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:25:15,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:25:15,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:25:15,070 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:25:15,070 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:25:15,074 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:25:45 +03)" executed successfully
2025-12-03 00:25:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:25:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:26:15.046892+03:00 (in 29.997732 seconds)
2025-12-03 00:25:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:26:15 +03)" (scheduled at 2025-12-03 00:25:45.046892+03:00)
2025-12-03 00:25:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:25:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 8}}, jsonrpc='2.0', id=8)
2025-12-03 00:25:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:25:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:25:45,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:25:45,057 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ebd0c00>
2025-12-03 00:25:45,058 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:25:45,058 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:25:45,059 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:25:45,059 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:25:45,059 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:25:45,059 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:25:45,061 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:25:45,061 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:25:45,062 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:25:45,069 [DEBUG] server.py:723 - Response sent
2025-12-03 00:25:45,070 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:25:45,071 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:25:45,072 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:25:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 00:25:45,073 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:25:45,073 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:25:45,073 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:25:45,074 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:25:45,074 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:25:45,077 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:26:15 +03)" executed successfully
2025-12-03 00:26:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:26:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:26:45.046892+03:00 (in 29.998586 seconds)
2025-12-03 00:26:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:26:45 +03)" (scheduled at 2025-12-03 00:26:15.046892+03:00)
2025-12-03 00:26:15,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:26:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 9}}, jsonrpc='2.0', id=9)
2025-12-03 00:26:15,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:26:15,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:26:15,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:26:15,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb22050>
2025-12-03 00:26:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:26:15,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:26:15,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:26:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:26:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:26:15,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:26:15,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:26:15,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:26:15,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:26:15,064 [DEBUG] server.py:723 - Response sent
2025-12-03 00:26:15,065 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:26:15,065 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:26:15,067 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:26:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 00:26:15,068 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:26:15,068 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:26:15,068 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:26:15,069 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:26:15,069 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:26:15,072 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:26:45 +03)" executed successfully
2025-12-03 00:26:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:26:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:27:15.046892+03:00 (in 29.997358 seconds)
2025-12-03 00:26:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:27:15 +03)" (scheduled at 2025-12-03 00:26:45.046892+03:00)
2025-12-03 00:26:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:26:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 10}}, jsonrpc='2.0', id=10)
2025-12-03 00:26:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:26:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:26:45,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:26:45,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb21950>
2025-12-03 00:26:45,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:26:45,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:26:45,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:26:45,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:26:45,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:26:45,059 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:26:45,061 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:26:45,061 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:26:45,062 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:26:45,068 [DEBUG] server.py:723 - Response sent
2025-12-03 00:26:45,069 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:26:45,069 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:26:45,071 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:26:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:26:45,071 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:26:45,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:26:45,072 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:26:45,072 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:26:45,072 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:26:45,075 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:27:15 +03)" executed successfully
2025-12-03 00:27:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:27:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:27:45.046892+03:00 (in 29.998913 seconds)
2025-12-03 00:27:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:27:45 +03)" (scheduled at 2025-12-03 00:27:15.046892+03:00)
2025-12-03 00:27:15,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:27:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 11}}, jsonrpc='2.0', id=11)
2025-12-03 00:27:15,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:27:15,050 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:27:15,050 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:27:15,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e893d40>
2025-12-03 00:27:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:27:15,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:27:15,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:27:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:27:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:27:15,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:27:15,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:27:15,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:27:15,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:27:15,064 [DEBUG] server.py:723 - Response sent
2025-12-03 00:27:15,065 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:27:15,065 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:27:15,067 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:27:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:27:15,067 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:27:15,068 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:27:15,068 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:27:15,068 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:27:15,068 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:27:15,072 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:27:45 +03)" executed successfully
2025-12-03 00:27:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:27:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:28:15.046892+03:00 (in 29.997594 seconds)
2025-12-03 00:27:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:28:15 +03)" (scheduled at 2025-12-03 00:27:45.046892+03:00)
2025-12-03 00:27:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:27:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 12}}, jsonrpc='2.0', id=12)
2025-12-03 00:27:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:27:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:27:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:27:45,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ea37110>
2025-12-03 00:27:45,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:27:45,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:27:45,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:27:45,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:27:45,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:27:45,058 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:27:45,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:27:45,059 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:27:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:27:45,066 [DEBUG] server.py:723 - Response sent
2025-12-03 00:27:45,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:27:45,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:27:45,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:27:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:27:45,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:27:45,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:27:45,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:27:45,071 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:27:45,071 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:27:45,074 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:28:15 +03)" executed successfully
2025-12-03 00:28:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:28:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:28:45.046892+03:00 (in 29.997513 seconds)
2025-12-03 00:28:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:28:45 +03)" (scheduled at 2025-12-03 00:28:15.046892+03:00)
2025-12-03 00:28:15,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:28:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 13}}, jsonrpc='2.0', id=13)
2025-12-03 00:28:15,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:28:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:28:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:28:15,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e990bb0>
2025-12-03 00:28:15,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:28:15,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:28:15,058 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:28:15,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:28:15,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:28:15,058 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:28:15,060 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:28:15,060 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:28:15,061 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:28:15,072 [DEBUG] server.py:723 - Response sent
2025-12-03 00:28:15,073 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:28:15,073 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:28:15,075 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:28:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:28:15,076 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:28:15,076 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:28:15,076 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:28:15,076 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:28:15,076 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:28:15,080 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:28:45 +03)" executed successfully
2025-12-03 00:28:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:28:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:29:15.046892+03:00 (in 29.997365 seconds)
2025-12-03 00:28:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:29:15 +03)" (scheduled at 2025-12-03 00:28:45.046892+03:00)
2025-12-03 00:28:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:28:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 14}}, jsonrpc='2.0', id=14)
2025-12-03 00:28:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:28:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:28:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:28:45,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb86f90>
2025-12-03 00:28:45,054 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:28:45,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:28:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:28:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:28:45,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:28:45,055 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:28:45,056 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:28:45,056 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:28:45,057 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:28:45,062 [DEBUG] server.py:723 - Response sent
2025-12-03 00:28:45,063 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:28:45,063 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:28:45,065 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:28:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:28:45,066 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:28:45,066 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:28:45,066 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:28:45,066 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:28:45,066 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:28:45,068 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:29:15 +03)" executed successfully
2025-12-03 00:29:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:29:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:29:45.046892+03:00 (in 29.997937 seconds)
2025-12-03 00:29:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:29:45 +03)" (scheduled at 2025-12-03 00:29:15.046892+03:00)
2025-12-03 00:29:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:29:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 15}}, jsonrpc='2.0', id=15)
2025-12-03 00:29:15,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:29:15,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:29:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:29:15,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eba6820>
2025-12-03 00:29:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:29:15,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:29:15,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:29:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:29:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:29:15,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:29:15,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:29:15,059 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:29:15,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:29:15,067 [DEBUG] server.py:723 - Response sent
2025-12-03 00:29:15,068 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:29:15,068 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:29:15,071 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:29:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:29:15,071 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:29:15,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:29:15,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:29:15,072 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:29:15,072 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:29:15,076 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:29:45 +03)" executed successfully
2025-12-03 00:29:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:29:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:30:15.046892+03:00 (in 29.997969 seconds)
2025-12-03 00:29:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:30:15 +03)" (scheduled at 2025-12-03 00:29:45.046892+03:00)
2025-12-03 00:29:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:29:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 16}}, jsonrpc='2.0', id=16)
2025-12-03 00:29:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:29:45,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:29:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:29:45,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eacea50>
2025-12-03 00:29:45,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:29:45,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:29:45,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:29:45,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:29:45,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:29:45,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:29:45,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:29:45,059 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:29:45,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:29:45,065 [DEBUG] server.py:723 - Response sent
2025-12-03 00:29:45,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:29:45,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:29:45,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:29:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:29:45,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:29:45,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:29:45,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:29:45,070 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:29:45,071 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:29:45,074 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:30:15 +03)" executed successfully
2025-12-03 00:30:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:30:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:30:45.046892+03:00 (in 29.997862 seconds)
2025-12-03 00:30:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:30:45 +03)" (scheduled at 2025-12-03 00:30:15.046892+03:00)
2025-12-03 00:30:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:30:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 17}}, jsonrpc='2.0', id=17)
2025-12-03 00:30:15,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:30:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:30:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:30:15,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eba8f50>
2025-12-03 00:30:15,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:30:15,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:30:15,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:30:15,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:30:15,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:30:15,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:30:15,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:30:15,059 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:30:15,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:30:15,066 [DEBUG] server.py:723 - Response sent
2025-12-03 00:30:15,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:30:15,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:30:15,069 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:30:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:30:15,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:30:15,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:30:15,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:30:15,070 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:30:15,070 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:30:15,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:30:45 +03)" executed successfully
2025-12-03 00:40:14,833 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:40:14,835 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:40:15.046892+03:00 (in 0.211280 seconds)
2025-12-03 00:40:14,835 [WARNING] base.py:176 - Run time of job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:40:15 +03)" was missed by 0:00:29.788947
2025-12-03 00:40:15,049 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:40:15,050 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:40:45.046892+03:00 (in 29.996834 seconds)
2025-12-03 00:40:15,050 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:40:45 +03)" (scheduled at 2025-12-03 00:40:15.046892+03:00)
2025-12-03 00:40:15,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:40:15,052 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 18}}, jsonrpc='2.0', id=18)
2025-12-03 00:40:15,053 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:40:15,054 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:40:15,054 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:40:15,057 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eaab120>
2025-12-03 00:40:15,058 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:40:15,058 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:40:15,058 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:40:15,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:40:15,059 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:40:15,059 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:40:15,061 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:40:15,061 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:40:15,061 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:40:15,067 [DEBUG] server.py:723 - Response sent
2025-12-03 00:40:15,068 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:40:15,068 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:40:15,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:40:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:40:15,071 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:40:15,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:40:15,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:40:15,071 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:40:15,072 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:40:15,075 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:40:45 +03)" executed successfully
2025-12-03 00:40:45,050 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:40:45,050 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:41:15.046892+03:00 (in 29.996060 seconds)
2025-12-03 00:40:45,051 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:41:15 +03)" (scheduled at 2025-12-03 00:40:45.046892+03:00)
2025-12-03 00:40:45,051 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:40:45,052 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 19}}, jsonrpc='2.0', id=19)
2025-12-03 00:40:45,053 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:40:45,054 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:40:45,054 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:40:45,058 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eaabd80>
2025-12-03 00:40:45,059 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:40:45,059 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:40:45,059 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:40:45,059 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:40:45,060 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:40:45,060 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:40:45,061 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:40:45,062 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:40:45,062 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:40:45,068 [DEBUG] server.py:723 - Response sent
2025-12-03 00:40:45,069 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:40:45,070 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:40:45,072 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:40:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:40:45,073 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:40:45,073 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:40:45,073 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:40:45,073 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:40:45,074 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:40:45,078 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:41:15 +03)" executed successfully
2025-12-03 00:58:15,799 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:58:15,801 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:58:45.046892+03:00 (in 29.245315 seconds)
2025-12-03 00:58:15,802 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:58:45 +03)" (scheduled at 2025-12-03 00:58:15.046892+03:00)
2025-12-03 00:58:15,802 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:58:15,802 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 20}}, jsonrpc='2.0', id=20)
2025-12-03 00:58:15,803 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:58:15,804 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:58:15,804 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:58:15,806 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e95be30>
2025-12-03 00:58:15,807 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:58:15,807 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:58:15,807 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:58:15,807 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:58:15,807 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:58:15,807 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:58:15,809 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:58:15,809 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:58:15,809 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:58:15,815 [DEBUG] server.py:723 - Response sent
2025-12-03 00:58:15,816 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:58:15,816 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:58:15,819 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:58:15 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:58:15,820 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:58:15,820 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:58:15,820 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:58:15,820 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:58:15,821 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:58:15,823 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:58:45 +03)" executed successfully
2025-12-03 00:58:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:58:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:59:15.046892+03:00 (in 29.997884 seconds)
2025-12-03 00:58:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:59:15 +03)" (scheduled at 2025-12-03 00:58:45.046892+03:00)
2025-12-03 00:58:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:58:45,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 21}}, jsonrpc='2.0', id=21)
2025-12-03 00:58:45,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:58:45,050 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:58:45,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:58:45,053 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb9a7b0>
2025-12-03 00:58:45,053 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:58:45,054 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:58:45,054 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:58:45,054 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:58:45,054 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:58:45,054 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:58:45,055 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:58:45,055 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:58:45,055 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:58:45,063 [DEBUG] server.py:723 - Response sent
2025-12-03 00:58:45,063 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:58:45,063 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:58:45,065 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:58:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:58:45,065 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:58:45,065 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:58:45,065 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:58:45,066 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:58:45,066 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:58:45,068 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:59:15 +03)" executed successfully
2025-12-03 00:59:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:59:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 00:59:45.046892+03:00 (in 29.997730 seconds)
2025-12-03 00:59:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:59:45 +03)" (scheduled at 2025-12-03 00:59:15.046892+03:00)
2025-12-03 00:59:15,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:59:15,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 22}}, jsonrpc='2.0', id=22)
2025-12-03 00:59:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:59:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:59:15,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:59:15,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eae7f50>
2025-12-03 00:59:15,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:59:15,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:59:15,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:59:15,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:59:15,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:59:15,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:59:15,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:59:15,059 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:59:15,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:59:15,065 [DEBUG] server.py:723 - Response sent
2025-12-03 00:59:15,066 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:59:15,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:59:15,068 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:59:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:59:15,068 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:59:15,068 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:59:15,069 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:59:15,069 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:59:15,069 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:59:15,071 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 00:59:45 +03)" executed successfully
2025-12-03 00:59:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 00:59:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:00:15.046892+03:00 (in 29.998436 seconds)
2025-12-03 00:59:45,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:00:15 +03)" (scheduled at 2025-12-03 00:59:45.046892+03:00)
2025-12-03 00:59:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 00:59:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 23}}, jsonrpc='2.0', id=23)
2025-12-03 00:59:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 00:59:45,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 00:59:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 00:59:45,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ebcdcd0>
2025-12-03 00:59:45,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 00:59:45,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 00:59:45,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 00:59:45,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 00:59:45,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 00:59:45,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 00:59:45,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 00:59:45,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 00:59:45,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 00:59:45,065 [DEBUG] server.py:723 - Response sent
2025-12-03 00:59:45,065 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 00:59:45,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 00:59:45,068 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 21:59:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 00:59:45,068 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 00:59:45,068 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 00:59:45,068 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 00:59:45,068 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 00:59:45,068 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 00:59:45,071 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:00:15 +03)" executed successfully
2025-12-03 01:00:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:00:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:00:45.046892+03:00 (in 29.998017 seconds)
2025-12-03 01:00:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:00:45 +03)" (scheduled at 2025-12-03 01:00:15.046892+03:00)
2025-12-03 01:00:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:00:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 24}}, jsonrpc='2.0', id=24)
2025-12-03 01:00:15,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:00:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:00:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:00:15,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb6e150>
2025-12-03 01:00:15,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:00:15,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:00:15,058 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:00:15,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:00:15,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:00:15,059 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:00:15,060 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:00:15,061 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:00:15,062 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:00:15,072 [DEBUG] server.py:723 - Response sent
2025-12-03 01:00:15,074 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:00:15,074 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:00:15,077 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:00:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:00:15,077 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:00:15,077 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:00:15,078 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:00:15,078 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:00:15,078 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:00:15,084 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:00:45 +03)" executed successfully
2025-12-03 01:00:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:00:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:01:15.046892+03:00 (in 29.997808 seconds)
2025-12-03 01:00:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:01:15 +03)" (scheduled at 2025-12-03 01:00:45.046892+03:00)
2025-12-03 01:00:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:00:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 25}}, jsonrpc='2.0', id=25)
2025-12-03 01:00:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:00:45,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:00:45,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:00:45,058 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb66ac0>
2025-12-03 01:00:45,059 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:00:45,060 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:00:45,060 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:00:45,060 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:00:45,060 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:00:45,061 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:00:45,063 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:00:45,063 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:00:45,064 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:00:45,073 [DEBUG] server.py:723 - Response sent
2025-12-03 01:00:45,075 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:00:45,075 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:00:45,077 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:00:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:00:45,078 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:00:45,078 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:00:45,078 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:00:45,078 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:00:45,079 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:00:45,082 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:01:15 +03)" executed successfully
2025-12-03 01:01:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:01:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:01:45.046892+03:00 (in 29.997818 seconds)
2025-12-03 01:01:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:01:45 +03)" (scheduled at 2025-12-03 01:01:15.046892+03:00)
2025-12-03 01:01:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:01:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 26}}, jsonrpc='2.0', id=26)
2025-12-03 01:01:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:01:15,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:01:15,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:01:15,057 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb67000>
2025-12-03 01:01:15,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:01:15,058 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:01:15,058 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:01:15,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:01:15,059 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:01:15,059 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:01:15,061 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:01:15,061 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:01:15,062 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:01:15,071 [DEBUG] server.py:723 - Response sent
2025-12-03 01:01:15,072 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:01:15,072 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:01:15,075 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:01:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:01:15,075 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:01:15,076 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:01:15,076 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:01:15,076 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:01:15,076 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:01:15,079 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:01:45 +03)" executed successfully
2025-12-03 01:01:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:01:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:02:15.046892+03:00 (in 29.998163 seconds)
2025-12-03 01:01:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:02:15 +03)" (scheduled at 2025-12-03 01:01:45.046892+03:00)
2025-12-03 01:01:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:01:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 27}}, jsonrpc='2.0', id=27)
2025-12-03 01:01:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:01:45,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:01:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:01:45,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ebec9b0>
2025-12-03 01:01:45,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:01:45,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:01:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:01:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:01:45,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:01:45,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:01:45,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:01:45,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:01:45,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:01:45,063 [DEBUG] server.py:723 - Response sent
2025-12-03 01:01:45,064 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:01:45,064 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:01:45,065 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:01:45 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:01:45,066 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:01:45,066 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:01:45,066 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:01:45,066 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:01:45,066 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:01:45,069 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:02:15 +03)" executed successfully
2025-12-03 01:02:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:02:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:02:45.046892+03:00 (in 29.998101 seconds)
2025-12-03 01:02:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:02:45 +03)" (scheduled at 2025-12-03 01:02:15.046892+03:00)
2025-12-03 01:02:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:02:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 28}}, jsonrpc='2.0', id=28)
2025-12-03 01:02:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:02:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:02:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:02:15,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ebedb50>
2025-12-03 01:02:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:02:15,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:02:15,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:02:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:02:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:02:15,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:02:15,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:02:15,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:02:15,057 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:02:15,064 [DEBUG] server.py:723 - Response sent
2025-12-03 01:02:15,065 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:02:15,065 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:02:15,066 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:02:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:02:15,067 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:02:15,067 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:02:15,067 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:02:15,067 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:02:15,067 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:02:15,070 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:02:45 +03)" executed successfully
2025-12-03 01:02:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:02:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:03:15.046892+03:00 (in 29.997767 seconds)
2025-12-03 01:02:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:03:15 +03)" (scheduled at 2025-12-03 01:02:45.046892+03:00)
2025-12-03 01:02:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:02:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 29}}, jsonrpc='2.0', id=29)
2025-12-03 01:02:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:02:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:02:45,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:02:45,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97d2c0>
2025-12-03 01:02:45,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:02:45,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:02:45,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:02:45,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:02:45,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:02:45,058 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:02:45,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:02:45,059 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:02:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:02:45,065 [DEBUG] server.py:723 - Response sent
2025-12-03 01:02:45,066 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:02:45,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:02:45,068 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:02:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:02:45,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:02:45,069 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:02:45,069 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:02:45,069 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:02:45,070 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:02:45,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:03:15 +03)" executed successfully
2025-12-03 01:03:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:03:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:03:45.046892+03:00 (in 29.998577 seconds)
2025-12-03 01:03:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:03:45 +03)" (scheduled at 2025-12-03 01:03:15.046892+03:00)
2025-12-03 01:03:15,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:03:15,048 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 30}}, jsonrpc='2.0', id=30)
2025-12-03 01:03:15,049 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:03:15,049 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:03:15,049 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:03:15,050 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97dd10>
2025-12-03 01:03:15,050 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:03:15,050 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:03:15,050 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:03:15,050 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:03:15,050 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:03:15,050 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:03:15,051 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:03:15,051 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:03:15,051 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:03:15,054 [DEBUG] server.py:723 - Response sent
2025-12-03 01:03:15,055 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:03:15,055 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:03:15,056 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:03:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:03:15,056 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:03:15,056 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:03:15,056 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:03:15,056 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:03:15,056 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:03:15,057 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:03:45 +03)" executed successfully
2025-12-03 01:03:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:03:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:04:15.046892+03:00 (in 29.998377 seconds)
2025-12-03 01:03:45,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:04:15 +03)" (scheduled at 2025-12-03 01:03:45.046892+03:00)
2025-12-03 01:03:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:03:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 31}}, jsonrpc='2.0', id=31)
2025-12-03 01:03:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:03:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:03:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:03:45,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97dae0>
2025-12-03 01:03:45,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:03:45,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:03:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:03:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:03:45,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:03:45,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:03:45,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:03:45,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:03:45,057 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:03:45,063 [DEBUG] server.py:723 - Response sent
2025-12-03 01:03:45,064 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:03:45,064 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:03:45,066 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:03:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:03:45,066 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:03:45,066 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:03:45,066 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:03:45,066 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:03:45,067 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:03:45,069 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:04:15 +03)" executed successfully
2025-12-03 01:04:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:04:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:04:45.046892+03:00 (in 29.997739 seconds)
2025-12-03 01:04:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:04:45 +03)" (scheduled at 2025-12-03 01:04:15.046892+03:00)
2025-12-03 01:04:15,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:04:15,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 32}}, jsonrpc='2.0', id=32)
2025-12-03 01:04:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:04:15,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:04:15,054 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:04:15,058 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ebc2210>
2025-12-03 01:04:15,059 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:04:15,060 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:04:15,060 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:04:15,060 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:04:15,061 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:04:15,061 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:04:15,063 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:04:15,064 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:04:15,064 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:04:15,073 [DEBUG] server.py:723 - Response sent
2025-12-03 01:04:15,075 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:04:15,075 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:04:15,078 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:04:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:04:15,078 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:04:15,078 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:04:15,079 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:04:15,079 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:04:15,079 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:04:15,082 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:04:45 +03)" executed successfully
2025-12-03 01:04:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:04:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:05:15.046892+03:00 (in 29.998520 seconds)
2025-12-03 01:04:45,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:05:15 +03)" (scheduled at 2025-12-03 01:04:45.046892+03:00)
2025-12-03 01:04:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:04:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 33}}, jsonrpc='2.0', id=33)
2025-12-03 01:04:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:04:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:04:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:04:45,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97ce10>
2025-12-03 01:04:45,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:04:45,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:04:45,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:04:45,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:04:45,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:04:45,058 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:04:45,060 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:04:45,060 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:04:45,061 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:04:45,070 [DEBUG] server.py:723 - Response sent
2025-12-03 01:04:45,071 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:04:45,071 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:04:45,074 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:04:45 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:04:45,074 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:04:45,075 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:04:45,075 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:04:45,075 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:04:45,075 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:04:45,079 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:05:15 +03)" executed successfully
2025-12-03 01:05:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:05:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:05:45.046892+03:00 (in 29.998842 seconds)
2025-12-03 01:05:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:05:45 +03)" (scheduled at 2025-12-03 01:05:15.046892+03:00)
2025-12-03 01:05:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:05:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 34}}, jsonrpc='2.0', id=34)
2025-12-03 01:05:15,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:05:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:05:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:05:15,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e93f160>
2025-12-03 01:05:15,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:05:15,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:05:15,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:05:15,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:05:15,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:05:15,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:05:15,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:05:15,059 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:05:15,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:05:15,067 [DEBUG] server.py:723 - Response sent
2025-12-03 01:05:15,068 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:05:15,068 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:05:15,071 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:05:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:05:15,071 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:05:15,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:05:15,072 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:05:15,072 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:05:15,072 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:05:15,075 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:05:45 +03)" executed successfully
2025-12-03 01:05:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:05:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:06:15.046892+03:00 (in 29.997903 seconds)
2025-12-03 01:05:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:06:15 +03)" (scheduled at 2025-12-03 01:05:45.046892+03:00)
2025-12-03 01:05:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:05:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 35}}, jsonrpc='2.0', id=35)
2025-12-03 01:05:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:05:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:05:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:05:45,058 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97d680>
2025-12-03 01:05:45,058 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:05:45,059 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:05:45,059 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:05:45,059 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:05:45,059 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:05:45,060 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:05:45,062 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:05:45,062 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:05:45,063 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:05:45,077 [DEBUG] server.py:723 - Response sent
2025-12-03 01:05:45,078 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:05:45,079 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:05:45,082 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:05:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:05:45,082 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:05:45,082 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:05:45,083 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:05:45,083 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:05:45,083 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:05:45,087 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:06:15 +03)" executed successfully
2025-12-03 01:06:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:06:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:06:45.046892+03:00 (in 29.997969 seconds)
2025-12-03 01:06:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:06:45 +03)" (scheduled at 2025-12-03 01:06:15.046892+03:00)
2025-12-03 01:06:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:06:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 36}}, jsonrpc='2.0', id=36)
2025-12-03 01:06:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:06:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:06:15,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:06:15,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec09b30>
2025-12-03 01:06:15,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:06:15,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:06:15,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:06:15,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:06:15,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:06:15,058 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:06:15,060 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:06:15,060 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:06:15,061 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:06:15,069 [DEBUG] server.py:723 - Response sent
2025-12-03 01:06:15,070 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:06:15,070 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:06:15,073 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:06:15 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:06:15,073 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:06:15,073 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:06:15,074 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:06:15,074 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:06:15,074 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:06:15,077 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:06:45 +03)" executed successfully
2025-12-03 01:06:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:06:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:07:15.046892+03:00 (in 29.997639 seconds)
2025-12-03 01:06:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:07:15 +03)" (scheduled at 2025-12-03 01:06:45.046892+03:00)
2025-12-03 01:06:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:06:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 37}}, jsonrpc='2.0', id=37)
2025-12-03 01:06:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:06:45,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:06:45,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:06:45,057 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec0bcf0>
2025-12-03 01:06:45,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:06:45,058 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:06:45,058 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:06:45,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:06:45,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:06:45,059 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:06:45,060 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:06:45,061 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:06:45,061 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:06:45,068 [DEBUG] server.py:723 - Response sent
2025-12-03 01:06:45,069 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:06:45,069 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:06:45,072 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:06:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:06:45,072 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:06:45,073 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:06:45,073 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:06:45,073 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:06:45,073 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:06:45,077 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:07:15 +03)" executed successfully
2025-12-03 01:07:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:07:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:07:45.046892+03:00 (in 29.997598 seconds)
2025-12-03 01:07:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:07:45 +03)" (scheduled at 2025-12-03 01:07:15.046892+03:00)
2025-12-03 01:07:15,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:07:15,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 38}}, jsonrpc='2.0', id=38)
2025-12-03 01:07:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:07:15,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:07:15,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:07:15,058 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e9c9d60>
2025-12-03 01:07:15,058 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:07:15,059 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:07:15,059 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:07:15,060 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:07:15,060 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:07:15,060 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:07:15,062 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:07:15,062 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:07:15,063 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:07:15,072 [DEBUG] server.py:723 - Response sent
2025-12-03 01:07:15,074 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:07:15,074 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:07:15,077 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:07:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:07:15,077 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:07:15,078 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:07:15,078 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:07:15,078 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:07:15,079 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:07:15,082 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:07:45 +03)" executed successfully
2025-12-03 01:07:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:07:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:08:15.046892+03:00 (in 29.997874 seconds)
2025-12-03 01:07:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:08:15 +03)" (scheduled at 2025-12-03 01:07:45.046892+03:00)
2025-12-03 01:07:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:07:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 39}}, jsonrpc='2.0', id=39)
2025-12-03 01:07:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:07:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:07:45,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:07:45,057 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb79f40>
2025-12-03 01:07:45,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:07:45,058 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:07:45,058 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:07:45,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:07:45,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:07:45,059 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:07:45,060 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:07:45,061 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:07:45,061 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:07:45,069 [DEBUG] server.py:723 - Response sent
2025-12-03 01:07:45,070 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:07:45,070 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:07:45,072 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:07:45 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:07:45,073 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:07:45,073 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:07:45,073 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:07:45,073 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:07:45,074 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:07:45,076 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:08:15 +03)" executed successfully
2025-12-03 01:08:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:08:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:08:45.046892+03:00 (in 29.997546 seconds)
2025-12-03 01:08:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:08:45 +03)" (scheduled at 2025-12-03 01:08:15.046892+03:00)
2025-12-03 01:08:15,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:08:15,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 40}}, jsonrpc='2.0', id=40)
2025-12-03 01:08:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:08:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:08:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:08:15,058 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb39540>
2025-12-03 01:08:15,058 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:08:15,059 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:08:15,059 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:08:15,059 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:08:15,059 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:08:15,060 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:08:15,061 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:08:15,061 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:08:15,062 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:08:15,069 [DEBUG] server.py:723 - Response sent
2025-12-03 01:08:15,070 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:08:15,070 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:08:15,073 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:08:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:08:15,073 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:08:15,073 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:08:15,073 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:08:15,074 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:08:15,074 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:08:15,076 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:08:45 +03)" executed successfully
2025-12-03 01:08:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:08:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:09:15.046892+03:00 (in 29.997600 seconds)
2025-12-03 01:08:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:09:15 +03)" (scheduled at 2025-12-03 01:08:45.046892+03:00)
2025-12-03 01:08:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:08:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 41}}, jsonrpc='2.0', id=41)
2025-12-03 01:08:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:08:45,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:08:45,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:08:45,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97d720>
2025-12-03 01:08:45,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:08:45,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:08:45,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:08:45,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:08:45,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:08:45,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:08:45,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:08:45,059 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:08:45,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:08:45,066 [DEBUG] server.py:723 - Response sent
2025-12-03 01:08:45,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:08:45,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:08:45,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:08:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:08:45,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:08:45,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:08:45,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:08:45,071 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:08:45,071 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:08:45,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:09:15 +03)" executed successfully
2025-12-03 01:09:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:09:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:09:45.046892+03:00 (in 29.998601 seconds)
2025-12-03 01:09:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:09:45 +03)" (scheduled at 2025-12-03 01:09:15.046892+03:00)
2025-12-03 01:09:15,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:09:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 42}}, jsonrpc='2.0', id=42)
2025-12-03 01:09:15,049 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:09:15,050 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:09:15,050 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:09:15,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97d590>
2025-12-03 01:09:15,054 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:09:15,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:09:15,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:09:15,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:09:15,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:09:15,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:09:15,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:09:15,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:09:15,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:09:15,065 [DEBUG] server.py:723 - Response sent
2025-12-03 01:09:15,066 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:09:15,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:09:15,068 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:09:15 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:09:15,068 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:09:15,069 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:09:15,069 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:09:15,069 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:09:15,069 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:09:15,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:09:45 +03)" executed successfully
2025-12-03 01:09:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:09:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:10:15.046892+03:00 (in 29.998012 seconds)
2025-12-03 01:09:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:10:15 +03)" (scheduled at 2025-12-03 01:09:45.046892+03:00)
2025-12-03 01:09:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:09:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 43}}, jsonrpc='2.0', id=43)
2025-12-03 01:09:45,053 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:09:45,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:09:45,054 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:09:45,058 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97d540>
2025-12-03 01:09:45,058 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:09:45,059 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:09:45,059 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:09:45,059 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:09:45,059 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:09:45,060 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:09:45,062 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:09:45,062 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:09:45,063 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:09:45,071 [DEBUG] server.py:723 - Response sent
2025-12-03 01:09:45,072 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:09:45,072 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:09:45,075 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:09:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:09:45,075 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:09:45,076 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:09:45,076 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:09:45,076 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:09:45,076 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:09:45,079 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:10:15 +03)" executed successfully
2025-12-03 01:10:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:10:15,047 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:10:45.046892+03:00 (in 29.998926 seconds)
2025-12-03 01:10:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:10:45 +03)" (scheduled at 2025-12-03 01:10:15.046892+03:00)
2025-12-03 01:10:15,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:10:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 44}}, jsonrpc='2.0', id=44)
2025-12-03 01:10:15,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:10:15,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:10:15,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:10:15,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97c0a0>
2025-12-03 01:10:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:10:15,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:10:15,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:10:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:10:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:10:15,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:10:15,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:10:15,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:10:15,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:10:15,065 [DEBUG] server.py:723 - Response sent
2025-12-03 01:10:15,066 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:10:15,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:10:15,068 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:10:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:10:15,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:10:15,069 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:10:15,069 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:10:15,069 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:10:15,069 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:10:15,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:10:45 +03)" executed successfully
2025-12-03 01:10:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:10:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:11:15.046892+03:00 (in 29.998194 seconds)
2025-12-03 01:10:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:11:15 +03)" (scheduled at 2025-12-03 01:10:45.046892+03:00)
2025-12-03 01:10:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:10:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 45}}, jsonrpc='2.0', id=45)
2025-12-03 01:10:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:10:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:10:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:10:45,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec08780>
2025-12-03 01:10:45,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:10:45,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:10:45,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:10:45,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:10:45,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:10:45,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:10:45,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:10:45,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:10:45,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:10:45,065 [DEBUG] server.py:723 - Response sent
2025-12-03 01:10:45,066 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:10:45,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:10:45,069 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:10:45 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:10:45,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:10:45,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:10:45,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:10:45,070 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:10:45,071 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:10:45,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:11:15 +03)" executed successfully
2025-12-03 01:11:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:11:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:11:45.046892+03:00 (in 29.998625 seconds)
2025-12-03 01:11:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:11:45 +03)" (scheduled at 2025-12-03 01:11:15.046892+03:00)
2025-12-03 01:11:15,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:11:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 46}}, jsonrpc='2.0', id=46)
2025-12-03 01:11:15,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:11:15,050 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:11:15,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:11:15,053 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec09770>
2025-12-03 01:11:15,054 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:11:15,054 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:11:15,054 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:11:15,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:11:15,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:11:15,055 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:11:15,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:11:15,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:11:15,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:11:15,066 [DEBUG] server.py:723 - Response sent
2025-12-03 01:11:15,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:11:15,068 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:11:15,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:11:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:11:15,071 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:11:15,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:11:15,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:11:15,071 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:11:15,071 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:11:15,076 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:11:45 +03)" executed successfully
2025-12-03 01:11:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:11:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:12:15.046892+03:00 (in 29.998406 seconds)
2025-12-03 01:11:45,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:12:15 +03)" (scheduled at 2025-12-03 01:11:45.046892+03:00)
2025-12-03 01:11:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:11:45,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 47}}, jsonrpc='2.0', id=47)
2025-12-03 01:11:45,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:11:45,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:11:45,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:11:45,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec08cd0>
2025-12-03 01:11:45,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:11:45,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:11:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:11:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:11:45,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:11:45,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:11:45,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:11:45,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:11:45,057 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:11:45,063 [DEBUG] server.py:723 - Response sent
2025-12-03 01:11:45,064 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:11:45,065 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:11:45,067 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:11:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:11:45,067 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:11:45,068 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:11:45,068 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:11:45,068 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:11:45,068 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:11:45,072 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:12:15 +03)" executed successfully
2025-12-03 01:12:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:12:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:12:45.046892+03:00 (in 29.998770 seconds)
2025-12-03 01:12:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:12:45 +03)" (scheduled at 2025-12-03 01:12:15.046892+03:00)
2025-12-03 01:12:15,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:12:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 48}}, jsonrpc='2.0', id=48)
2025-12-03 01:12:15,049 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:12:15,050 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:12:15,050 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:12:15,052 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb78230>
2025-12-03 01:12:15,053 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:12:15,054 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:12:15,054 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:12:15,054 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:12:15,054 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:12:15,054 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:12:15,055 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:12:15,056 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:12:15,056 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:12:15,061 [DEBUG] server.py:723 - Response sent
2025-12-03 01:12:15,062 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:12:15,062 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:12:15,064 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:12:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:12:15,064 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:12:15,065 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:12:15,065 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:12:15,065 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:12:15,065 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:12:15,068 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:12:45 +03)" executed successfully
2025-12-03 01:12:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:12:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:13:15.046892+03:00 (in 29.997692 seconds)
2025-12-03 01:12:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:13:15 +03)" (scheduled at 2025-12-03 01:12:45.046892+03:00)
2025-12-03 01:12:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:12:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 49}}, jsonrpc='2.0', id=49)
2025-12-03 01:12:45,053 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:12:45,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:12:45,054 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:12:45,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e93f480>
2025-12-03 01:12:45,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:12:45,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:12:45,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:12:45,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:12:45,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:12:45,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:12:45,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:12:45,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:12:45,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:12:45,066 [DEBUG] server.py:723 - Response sent
2025-12-03 01:12:45,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:12:45,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:12:45,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:12:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:12:45,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:12:45,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:12:45,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:12:45,072 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:12:45,072 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:12:45,074 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:13:15 +03)" executed successfully
2025-12-03 01:13:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:13:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:13:45.046892+03:00 (in 29.997552 seconds)
2025-12-03 01:13:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:13:45 +03)" (scheduled at 2025-12-03 01:13:15.046892+03:00)
2025-12-03 01:13:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:13:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 50}}, jsonrpc='2.0', id=50)
2025-12-03 01:13:15,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:13:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:13:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:13:15,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97dae0>
2025-12-03 01:13:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:13:15,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:13:15,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:13:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:13:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:13:15,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:13:15,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:13:15,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:13:15,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:13:15,066 [DEBUG] server.py:723 - Response sent
2025-12-03 01:13:15,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:13:15,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:13:15,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:13:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:13:15,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:13:15,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:13:15,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:13:15,071 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:13:15,072 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:13:15,074 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:13:45 +03)" executed successfully
2025-12-03 01:13:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:13:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:14:15.046892+03:00 (in 29.998193 seconds)
2025-12-03 01:13:45,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:14:15 +03)" (scheduled at 2025-12-03 01:13:45.046892+03:00)
2025-12-03 01:13:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:13:45,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 51}}, jsonrpc='2.0', id=51)
2025-12-03 01:13:45,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:13:45,050 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:13:45,050 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:13:45,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97cd20>
2025-12-03 01:13:45,054 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:13:45,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:13:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:13:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:13:45,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:13:45,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:13:45,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:13:45,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:13:45,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:13:45,065 [DEBUG] server.py:723 - Response sent
2025-12-03 01:13:45,066 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:13:45,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:13:45,069 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:13:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:13:45,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:13:45,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:13:45,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:13:45,070 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:13:45,071 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:13:45,074 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:14:15 +03)" executed successfully
2025-12-03 01:14:15,058 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:14:15,058 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:14:45.046892+03:00 (in 29.988308 seconds)
2025-12-03 01:14:15,058 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:14:45 +03)" (scheduled at 2025-12-03 01:14:15.046892+03:00)
2025-12-03 01:14:15,059 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:14:15,060 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 52}}, jsonrpc='2.0', id=52)
2025-12-03 01:14:15,061 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:14:15,061 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:14:15,062 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:14:15,065 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec09a90>
2025-12-03 01:14:15,065 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:14:15,066 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:14:15,066 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:14:15,066 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:14:15,066 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:14:15,067 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:14:15,068 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:14:15,068 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:14:15,069 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:14:15,076 [DEBUG] server.py:723 - Response sent
2025-12-03 01:14:15,078 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:14:15,078 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:14:15,080 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:14:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:14:15,081 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:14:15,081 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:14:15,081 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:14:15,081 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:14:15,081 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:14:15,084 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:14:45 +03)" executed successfully
2025-12-03 01:14:45,051 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:14:45,052 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:15:15.046892+03:00 (in 29.994756 seconds)
2025-12-03 01:14:45,052 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:15:15 +03)" (scheduled at 2025-12-03 01:14:45.046892+03:00)
2025-12-03 01:14:45,052 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:14:45,053 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 53}}, jsonrpc='2.0', id=53)
2025-12-03 01:14:45,055 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:14:45,055 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:14:45,056 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:14:45,059 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e9ca080>
2025-12-03 01:14:45,060 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:14:45,060 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:14:45,060 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:14:45,060 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:14:45,060 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:14:45,061 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:14:45,063 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:14:45,063 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:14:45,064 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:14:45,070 [DEBUG] server.py:723 - Response sent
2025-12-03 01:14:45,071 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:14:45,072 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:14:45,074 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:14:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:14:45,074 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:14:45,075 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:14:45,075 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:14:45,075 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:14:45,076 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:14:45,079 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:15:15 +03)" executed successfully
2025-12-03 01:15:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:15:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:15:45.046892+03:00 (in 29.997250 seconds)
2025-12-03 01:15:15,050 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:15:45 +03)" (scheduled at 2025-12-03 01:15:15.046892+03:00)
2025-12-03 01:15:15,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:15:15,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 54}}, jsonrpc='2.0', id=54)
2025-12-03 01:15:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:15:15,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:15:15,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:15:15,057 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec0a6c0>
2025-12-03 01:15:15,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:15:15,058 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:15:15,058 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:15:15,058 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:15:15,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:15:15,059 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:15:15,060 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:15:15,061 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:15:15,061 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:15:15,068 [DEBUG] server.py:723 - Response sent
2025-12-03 01:15:15,069 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:15:15,069 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:15:15,071 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:15:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:15:15,072 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:15:15,072 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:15:15,073 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:15:15,073 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:15:15,073 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:15:15,076 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:15:45 +03)" executed successfully
2025-12-03 01:15:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:15:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:16:15.046892+03:00 (in 29.998448 seconds)
2025-12-03 01:15:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:16:15 +03)" (scheduled at 2025-12-03 01:15:45.046892+03:00)
2025-12-03 01:15:45,052 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:15:45,055 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 55}}, jsonrpc='2.0', id=55)
2025-12-03 01:15:45,059 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:15:45,059 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:15:45,059 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:15:45,062 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec096d0>
2025-12-03 01:15:45,065 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:15:45,065 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:15:45,065 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:15:45,065 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:15:45,068 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:15:45,068 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:15:45,071 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:15:45,071 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:15:45,071 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:15:45,078 [DEBUG] server.py:723 - Response sent
2025-12-03 01:15:45,079 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:15:45,079 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:15:45,081 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:15:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:15:45,082 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:15:45,082 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:15:45,083 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:15:45,083 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:15:45,084 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:15:45,087 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:16:15 +03)" executed successfully
2025-12-03 01:16:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:16:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:16:45.046892+03:00 (in 29.997736 seconds)
2025-12-03 01:16:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:16:45 +03)" (scheduled at 2025-12-03 01:16:15.046892+03:00)
2025-12-03 01:16:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:16:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 56}}, jsonrpc='2.0', id=56)
2025-12-03 01:16:15,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:16:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:16:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:16:15,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec29270>
2025-12-03 01:16:15,054 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:16:15,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:16:15,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:16:15,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:16:15,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:16:15,055 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:16:15,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:16:15,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:16:15,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:16:15,064 [DEBUG] server.py:723 - Response sent
2025-12-03 01:16:15,065 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:16:15,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:16:15,069 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:16:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:16:15,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:16:15,069 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:16:15,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:16:15,070 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:16:15,070 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:16:15,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:16:45 +03)" executed successfully
2025-12-03 01:16:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:16:45,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:17:15.046892+03:00 (in 29.997925 seconds)
2025-12-03 01:16:45,050 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:17:15 +03)" (scheduled at 2025-12-03 01:16:45.046892+03:00)
2025-12-03 01:16:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:16:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 57}}, jsonrpc='2.0', id=57)
2025-12-03 01:16:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:16:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:16:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:16:45,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97d450>
2025-12-03 01:16:45,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:16:45,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:16:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:16:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:16:45,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:16:45,055 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:16:45,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:16:45,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:16:45,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:16:45,068 [DEBUG] server.py:723 - Response sent
2025-12-03 01:16:45,069 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:16:45,070 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:16:45,072 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:16:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:16:45,073 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:16:45,073 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:16:45,073 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:16:45,073 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:16:45,074 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:16:45,077 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:17:15 +03)" executed successfully
2025-12-03 01:17:15,049 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:17:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:17:45.046892+03:00 (in 29.996984 seconds)
2025-12-03 01:17:15,050 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:17:45 +03)" (scheduled at 2025-12-03 01:17:15.046892+03:00)
2025-12-03 01:17:15,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:17:15,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 58}}, jsonrpc='2.0', id=58)
2025-12-03 01:17:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:17:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:17:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:17:15,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97ce10>
2025-12-03 01:17:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:17:15,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:17:15,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:17:15,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:17:15,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:17:15,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:17:15,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:17:15,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:17:15,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:17:15,064 [DEBUG] server.py:723 - Response sent
2025-12-03 01:17:15,065 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:17:15,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:17:15,069 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:17:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:17:15,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:17:15,069 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:17:15,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:17:15,070 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:17:15,070 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:17:15,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:17:45 +03)" executed successfully
2025-12-03 01:17:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:17:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:18:15.046892+03:00 (in 29.998653 seconds)
2025-12-03 01:17:45,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:18:15 +03)" (scheduled at 2025-12-03 01:17:45.046892+03:00)
2025-12-03 01:17:45,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:17:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 59}}, jsonrpc='2.0', id=59)
2025-12-03 01:17:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:17:45,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:17:45,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:17:45,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e97d860>
2025-12-03 01:17:45,054 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:17:45,055 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:17:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:17:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:17:45,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:17:45,055 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:17:45,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:17:45,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:17:45,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:17:45,068 [DEBUG] server.py:723 - Response sent
2025-12-03 01:17:45,069 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:17:45,069 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:17:45,071 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:17:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:17:45,071 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:17:45,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:17:45,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:17:45,072 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:17:45,072 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:17:45,075 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:18:15 +03)" executed successfully
2025-12-03 01:18:15,049 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:18:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:18:45.046892+03:00 (in 29.997254 seconds)
2025-12-03 01:18:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:18:45 +03)" (scheduled at 2025-12-03 01:18:15.046892+03:00)
2025-12-03 01:18:15,050 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:18:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 60}}, jsonrpc='2.0', id=60)
2025-12-03 01:18:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:18:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:18:15,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:18:15,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb43e80>
2025-12-03 01:18:15,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:18:15,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:18:15,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:18:15,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:18:15,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:18:15,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:18:15,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:18:15,059 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:18:15,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:18:15,066 [DEBUG] server.py:723 - Response sent
2025-12-03 01:18:15,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:18:15,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:18:15,069 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:18:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:18:15,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:18:15,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:18:15,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:18:15,070 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:18:15,070 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:18:15,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:18:45 +03)" executed successfully
2025-12-03 01:18:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:18:45,051 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:19:15.046892+03:00 (in 29.995391 seconds)
2025-12-03 01:18:45,051 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:19:15 +03)" (scheduled at 2025-12-03 01:18:45.046892+03:00)
2025-12-03 01:18:45,051 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:18:45,052 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 61}}, jsonrpc='2.0', id=61)
2025-12-03 01:18:45,053 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:18:45,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:18:45,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:18:45,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb79e50>
2025-12-03 01:18:45,057 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:18:45,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:18:45,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:18:45,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:18:45,057 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:18:45,058 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:18:45,060 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:18:45,060 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:18:45,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:18:45,067 [DEBUG] server.py:723 - Response sent
2025-12-03 01:18:45,068 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:18:45,068 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:18:45,072 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:18:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:18:45,072 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:18:45,072 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:18:45,072 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:18:45,073 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:18:45,073 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:18:45,076 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:19:15 +03)" executed successfully
2025-12-03 01:19:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:19:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:19:45.046892+03:00 (in 29.998389 seconds)
2025-12-03 01:19:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:19:45 +03)" (scheduled at 2025-12-03 01:19:15.046892+03:00)
2025-12-03 01:19:15,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:19:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 62}}, jsonrpc='2.0', id=62)
2025-12-03 01:19:15,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:19:15,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:19:15,051 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:19:15,055 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e9c9e00>
2025-12-03 01:19:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:19:15,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:19:15,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:19:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:19:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:19:15,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:19:15,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:19:15,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:19:15,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:19:15,065 [DEBUG] server.py:723 - Response sent
2025-12-03 01:19:15,066 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:19:15,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:19:15,069 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:19:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:19:15,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:19:15,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:19:15,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:19:15,071 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:19:15,071 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:19:15,074 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:19:45 +03)" executed successfully
2025-12-03 01:19:45,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:19:45,050 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:20:15.046892+03:00 (in 29.996364 seconds)
2025-12-03 01:19:45,050 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:20:15 +03)" (scheduled at 2025-12-03 01:19:45.046892+03:00)
2025-12-03 01:19:45,051 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:19:45,051 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 63}}, jsonrpc='2.0', id=63)
2025-12-03 01:19:45,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:19:45,053 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:19:45,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:19:45,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e9ca440>
2025-12-03 01:19:45,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:19:45,059 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:19:45,062 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:19:45,062 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:19:45,062 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:19:45,063 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:19:45,064 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:19:45,064 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:19:45,065 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:19:45,073 [DEBUG] server.py:723 - Response sent
2025-12-03 01:19:45,075 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:19:45,075 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:19:45,077 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:19:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:19:45,078 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:19:45,078 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:19:45,078 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:19:45,079 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:19:45,079 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:19:45,081 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:20:15 +03)" executed successfully
2025-12-03 01:20:45,277 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:20:45,278 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:21:15.046892+03:00 (in 29.768836 seconds)
2025-12-03 01:20:45,278 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:21:15 +03)" (scheduled at 2025-12-03 01:20:45.046892+03:00)
2025-12-03 01:20:45,278 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:20:45,280 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 64}}, jsonrpc='2.0', id=64)
2025-12-03 01:20:45,281 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:20:45,282 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:20:45,282 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:20:45,286 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec2a940>
2025-12-03 01:20:45,286 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:20:45,287 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:20:45,287 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:20:45,288 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:20:45,288 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:20:45,288 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:20:45,290 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:20:45,290 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:20:45,291 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:20:45,301 [DEBUG] server.py:723 - Response sent
2025-12-03 01:20:45,303 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:20:45,303 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:20:45,306 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:20:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:20:45,307 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:20:45,307 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:20:45,308 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:20:45,308 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:20:45,308 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:20:45,311 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:21:15 +03)" executed successfully
2025-12-03 01:22:48,658 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:22:48,659 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:23:15.046892+03:00 (in 26.387696 seconds)
2025-12-03 01:22:48,659 [WARNING] base.py:176 - Run time of job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:23:15 +03)" was missed by 0:00:03.612754
2025-12-03 01:23:15,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:23:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:23:45.046892+03:00 (in 29.998609 seconds)
2025-12-03 01:23:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:23:45 +03)" (scheduled at 2025-12-03 01:23:15.046892+03:00)
2025-12-03 01:23:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:23:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 65}}, jsonrpc='2.0', id=65)
2025-12-03 01:23:15,051 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:23:15,051 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:23:15,052 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:23:15,054 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec0a760>
2025-12-03 01:23:15,055 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:23:15,056 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:23:15,056 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:23:15,056 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:23:15,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:23:15,057 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:23:15,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:23:15,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:23:15,059 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:23:15,066 [DEBUG] server.py:723 - Response sent
2025-12-03 01:23:15,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:23:15,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:23:15,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:23:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:23:15,071 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:23:15,071 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:23:15,072 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:23:15,072 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:23:15,072 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:23:15,075 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:23:45 +03)" executed successfully
2025-12-03 01:23:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:23:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:24:15.046892+03:00 (in 29.998802 seconds)
2025-12-03 01:23:45,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:24:15 +03)" (scheduled at 2025-12-03 01:23:45.046892+03:00)
2025-12-03 01:23:45,048 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:23:45,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 66}}, jsonrpc='2.0', id=66)
2025-12-03 01:23:45,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:23:45,050 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:23:45,050 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:23:45,053 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec2b2f0>
2025-12-03 01:23:45,053 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:23:45,054 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:23:45,055 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:23:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:23:45,056 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:23:45,056 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:23:45,058 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:23:45,058 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:23:45,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:23:45,066 [DEBUG] server.py:723 - Response sent
2025-12-03 01:23:45,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:23:45,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:23:45,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:23:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:23:45,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:23:45,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:23:45,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:23:45,071 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:23:45,071 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:23:45,075 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:24:15 +03)" executed successfully
2025-12-03 01:24:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:24:15,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:24:45.046892+03:00 (in 29.998110 seconds)
2025-12-03 01:24:15,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:24:45 +03)" (scheduled at 2025-12-03 01:24:15.046892+03:00)
2025-12-03 01:24:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:24:15,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 67}}, jsonrpc='2.0', id=67)
2025-12-03 01:24:15,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:24:15,050 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:24:15,050 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:24:15,053 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ec0bf20>
2025-12-03 01:24:15,054 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:24:15,054 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:24:15,054 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:24:15,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:24:15,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:24:15,055 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:24:15,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:24:15,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:24:15,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:24:15,066 [DEBUG] server.py:723 - Response sent
2025-12-03 01:24:15,067 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:24:15,067 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:24:15,070 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:24:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:24:15,070 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:24:15,070 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:24:15,071 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:24:15,071 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:24:15,071 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:24:15,074 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:24:45 +03)" executed successfully
2025-12-03 01:24:45,047 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:24:45,048 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:25:15.046892+03:00 (in 29.998297 seconds)
2025-12-03 01:24:45,048 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:25:15 +03)" (scheduled at 2025-12-03 01:24:45.046892+03:00)
2025-12-03 01:24:45,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:24:45,049 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 68}}, jsonrpc='2.0', id=68)
2025-12-03 01:24:45,050 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:24:45,050 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:24:45,050 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:24:45,053 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e99d090>
2025-12-03 01:24:45,054 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:24:45,054 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:24:45,054 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:24:45,055 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:24:45,055 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:24:45,055 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:24:45,057 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:24:45,057 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:24:45,058 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:24:45,065 [DEBUG] server.py:723 - Response sent
2025-12-03 01:24:45,066 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:24:45,066 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:24:45,069 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:24:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:24:45,069 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:24:45,069 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:24:45,070 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:24:45,070 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:24:45,070 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:24:45,073 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:25:15 +03)" executed successfully
2025-12-03 01:25:15,048 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 01:25:15,049 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 01:25:45.046892+03:00 (in 29.997669 seconds)
2025-12-03 01:25:15,049 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:25:45 +03)" (scheduled at 2025-12-03 01:25:15.046892+03:00)
2025-12-03 01:25:15,049 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 01:25:15,050 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 69}}, jsonrpc='2.0', id=69)
2025-12-03 01:25:15,052 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:25:15,052 [DEBUG] _trace.py:87 - close.complete
2025-12-03 01:25:15,053 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 01:25:15,056 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eb79b30>
2025-12-03 01:25:15,056 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 01:25:15,057 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 01:25:15,057 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 01:25:15,057 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 01:25:15,058 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 01:25:15,058 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 01:25:15,059 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 01:25:15,060 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 01:25:15,060 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 01:25:15,067 [DEBUG] server.py:723 - Response sent
2025-12-03 01:25:15,068 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 01:25:15,069 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 01:25:15,071 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 22:25:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86076')])
2025-12-03 01:25:15,072 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 01:25:15,072 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 01:25:15,072 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 01:25:15,073 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 01:25:15,073 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 01:25:15,076 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 01:25:45 +03)" executed successfully
2025-12-03 01:25:22,841 [INFO] streamable_http_manager.py:114 - StreamableHTTP session manager shutting down
2025-12-03 01:25:22,841 [INFO] mcp_server.py:178 - Stopping MCP Database Server...
2025-12-03 01:25:22,841 [INFO] metadata_scheduler_manager.py:182 - Scheduler stopped
2025-12-03 01:25:22,843 [INFO] base.py:245 - Scheduler has been shut down
2025-12-03 01:25:22,844 [DEBUG] _trace.py:87 - close.started
2025-12-03 01:25:22,844 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:03:11,928 [DEBUG] selector_events.py:64 - Using selector: KqueueSelector
2025-12-03 02:03:11,929 [INFO] main.py:10 - Started
2025-12-03 02:03:11,929 [INFO] mcp_server.py:134 - Starting MCP Database Server...
2025-12-03 02:03:11,929 [DEBUG] server.py:157 - Initializing server 'DBMCPServer ðŸš€'
2025-12-03 02:03:11,929 [DEBUG] server.py:414 - Registering handler for ListToolsRequest
2025-12-03 02:03:11,929 [DEBUG] server.py:281 - Registering handler for ListResourcesRequest
2025-12-03 02:03:11,929 [DEBUG] server.py:301 - Registering handler for ListResourceTemplatesRequest
2025-12-03 02:03:11,929 [DEBUG] server.py:243 - Registering handler for PromptListRequest
2025-12-03 02:03:11,929 [DEBUG] server.py:486 - Registering handler for CallToolRequest
2025-12-03 02:03:11,929 [DEBUG] server.py:316 - Registering handler for ReadResourceRequest
2025-12-03 02:03:11,929 [DEBUG] server.py:265 - Registering handler for GetPromptRequest
2025-12-03 02:03:11,936 [INFO] factory.py:76 - All fetchers initialized
2025-12-03 02:03:11,971 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 5
2025-12-03 02:03:12,004 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 13
2025-12-03 02:03:12,005 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 14
2025-12-03 02:03:12,009 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdarmutlu@localhost:5432/omdb [id=5]
2025-12-03 02:03:12,012 [INFO] postgresql_manager.py:39 - 5 is activated
2025-12-03 02:03:12,038 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: postgres@pg1:5432/demo [id=13]
2025-12-03 02:03:12,039 [INFO] postgresql_manager.py:39 - 13 is activated
2025-12-03 02:03:12,041 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdar@pg2:5432/Adventureworks [id=14]
2025-12-03 02:03:12,042 [INFO] postgresql_manager.py:39 - 14 is activated
2025-12-03 02:03:12,042 [INFO] postgresql_manager.py:66 - âœ… DB Manager initialized. Active pools: 3
2025-12-03 02:03:12,044 [INFO] base.py:507 - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-12-03 02:03:12,044 [INFO] metadata_scheduler_manager.py:170 - Loaded job: Test2
2025-12-03 02:03:12,045 [INFO] base.py:1090 - Added job "SchedulerManager.execute_job" to job store "default"
2025-12-03 02:03:12,045 [INFO] base.py:214 - Scheduler started
2025-12-03 02:03:12,045 [INFO] metadata_scheduler_manager.py:175 - Scheduler started
2025-12-03 02:03:12,082 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:03:12,082 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:03:42.044866+03:00 (in 29.962480 seconds)
2025-12-03 02:03:12,082 [INFO] streamable_http_manager.py:110 - StreamableHTTP session manager started
2025-12-03 02:03:42,046 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:03:42,046 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:04:12.044866+03:00 (in 29.998280 seconds)
2025-12-03 02:03:42,046 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:04:12 +03)" (scheduled at 2025-12-03 02:03:42.044866+03:00)
2025-12-03 02:03:42,047 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:03:42,047 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:03:42,085 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:03:42,086 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:03:42,088 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10d034050>
2025-12-03 02:03:42,088 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:03:42,088 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:03:42,088 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:03:42,088 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:03:42,088 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:03:42,089 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:03:42,089 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:03:42,089 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 02:03:42,091 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:03:41 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'422')])
2025-12-03 02:03:42,091 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:03:42,092 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:03:42,092 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:03:42,092 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:03:42,092 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:03:42,092 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:03:42,092 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:03:42,093 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:03:42,093 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:03:42,093 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:03:42,093 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:03:42,093 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:03:42,093 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:03:42,093 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:03:42,093 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:03:41 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'0')])
2025-12-03 02:03:42,093 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:03:42,093 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:03:42,093 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:03:42,094 [DEBUG] session.py:426 - Read stream closed by client
2025-12-03 02:03:42,094 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:03:42,094 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:03:42,094 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:03:42,095 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10d03c550>
2025-12-03 02:03:42,095 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:03:42,095 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:03:42,095 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:03:42,095 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:03:42,095 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:03:42,095 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:03:42,096 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:03:42,096 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:03:42,096 [DEBUG] server.py:456 - Tool cache miss for list-all-tables, refreshing cache
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,097 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,130 [DEBUG] server.py:723 - Response sent
2025-12-03 02:03:42,131 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:03:42,131 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 02:03:42,131 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:03:41 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 02:03:42,132 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:03:42,132 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:03:42,132 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:03:42,132 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:03:42,132 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:03:42,133 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:03:42,133 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:03:42,133 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:03:42,133 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:03:42,133 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:03:42,133 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:03:42,133 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:03:42,134 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:03:42,134 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:03:42,134 [DEBUG] server.py:723 - Response sent
2025-12-03 02:03:42,135 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:03:42,135 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 02:03:42,135 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:03:41 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'3119')])
2025-12-03 02:03:42,135 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:03:42,135 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:03:42,135 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:03:42,135 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:03:42,136 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:03:42,137 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:03:42,137 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:03:42,138 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:04:12 +03)" executed successfully
2025-12-03 02:03:51,686 [INFO] streamable_http_manager.py:114 - StreamableHTTP session manager shutting down
2025-12-03 02:14:14,504 [DEBUG] selector_events.py:64 - Using selector: KqueueSelector
2025-12-03 02:14:14,504 [INFO] main.py:10 - Started
2025-12-03 02:14:14,504 [INFO] mcp_server.py:134 - Starting MCP Database Server...
2025-12-03 02:14:14,505 [DEBUG] server.py:157 - Initializing server 'DBMCPServer ðŸš€'
2025-12-03 02:14:14,505 [DEBUG] server.py:414 - Registering handler for ListToolsRequest
2025-12-03 02:14:14,505 [DEBUG] server.py:281 - Registering handler for ListResourcesRequest
2025-12-03 02:14:14,505 [DEBUG] server.py:301 - Registering handler for ListResourceTemplatesRequest
2025-12-03 02:14:14,505 [DEBUG] server.py:243 - Registering handler for PromptListRequest
2025-12-03 02:14:14,505 [DEBUG] server.py:486 - Registering handler for CallToolRequest
2025-12-03 02:14:14,505 [DEBUG] server.py:316 - Registering handler for ReadResourceRequest
2025-12-03 02:14:14,505 [DEBUG] server.py:265 - Registering handler for GetPromptRequest
2025-12-03 02:14:14,511 [INFO] factory.py:76 - All fetchers initialized
2025-12-03 02:14:14,543 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 5
2025-12-03 02:14:14,573 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 13
2025-12-03 02:14:14,574 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 14
2025-12-03 02:14:14,579 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdarmutlu@localhost:5432/omdb [id=5]
2025-12-03 02:14:14,581 [INFO] postgresql_manager.py:39 - 5 is activated
2025-12-03 02:14:14,589 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: postgres@pg1:5432/demo [id=13]
2025-12-03 02:14:14,590 [INFO] postgresql_manager.py:39 - 13 is activated
2025-12-03 02:14:14,604 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdar@pg2:5432/Adventureworks [id=14]
2025-12-03 02:14:14,606 [INFO] postgresql_manager.py:39 - 14 is activated
2025-12-03 02:14:14,606 [INFO] postgresql_manager.py:66 - âœ… DB Manager initialized. Active pools: 3
2025-12-03 02:14:14,608 [INFO] base.py:507 - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-12-03 02:14:14,608 [INFO] metadata_scheduler_manager.py:170 - Loaded job: Test2
2025-12-03 02:14:14,608 [INFO] base.py:1090 - Added job "SchedulerManager.execute_job" to job store "default"
2025-12-03 02:14:14,608 [INFO] base.py:214 - Scheduler started
2025-12-03 02:14:14,608 [INFO] metadata_scheduler_manager.py:175 - Scheduler started
2025-12-03 02:14:14,618 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:14:14,618 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:14:44.607969+03:00 (in 29.989669 seconds)
2025-12-03 02:14:14,618 [INFO] streamable_http_manager.py:110 - StreamableHTTP session manager started
2025-12-03 02:14:44,609 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:14:44,609 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:15:14.607969+03:00 (in 29.998043 seconds)
2025-12-03 02:14:44,610 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:15:14 +03)" (scheduled at 2025-12-03 02:14:44.607969+03:00)
2025-12-03 02:14:44,610 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:14:44,610 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:14:44,630 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:14:44,631 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:14:44,632 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ef2bcb0>
2025-12-03 02:14:44,632 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:14:44,633 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:14:44,633 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:14:44,633 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:14:44,633 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:14:44,633 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:14:44,633 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: a467294ab7544ee484e97101ff1f4aee
2025-12-03 02:14:44,635 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:14:43 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'a467294ab7544ee484e97101ff1f4aee'), (b'content-length', b'422')])
2025-12-03 02:14:44,635 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:14:44,635 [INFO] streamable_http.py:134 - Received session ID: a467294ab7544ee484e97101ff1f4aee
2025-12-03 02:14:44,635 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:14:44,635 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:14:44,635 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:14:44,635 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:14:44,635 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:14:44,635 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:14:44,636 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:14:44,636 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:14:44,636 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:14:44,636 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:14:44,636 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:14:44,637 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:14:44,637 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:14:44,637 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:14:43 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'a467294ab7544ee484e97101ff1f4aee'), (b'content-length', b'0')])
2025-12-03 02:14:44,637 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:14:44,637 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:14:44,637 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:14:44,637 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:14:44,637 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:14:44,638 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:14:44,638 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10efee350>
2025-12-03 02:14:44,638 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'GET']>
2025-12-03 02:14:44,638 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:14:44,639 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'GET']>
2025-12-03 02:14:44,639 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:14:44,639 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'GET']>
2025-12-03 02:14:44,639 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:14:44,639 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:14:43 GMT'), (b'server', b'uvicorn'), (b'cache-control', b'no-cache, no-transform'), (b'connection', b'keep-alive'), (b'content-type', b'text/event-stream'), (b'mcp-session-id', b'a467294ab7544ee484e97101ff1f4aee'), (b'x-accel-buffering', b'no'), (b'transfer-encoding', b'chunked')])
2025-12-03 02:14:44,639 [INFO] _client.py:1740 - HTTP Request: GET http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:14:44,639 [DEBUG] streamable_http.py:212 - GET SSE connection established
2025-12-03 02:14:44,640 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'GET']>
2025-12-03 02:14:44,640 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eec7b10>
2025-12-03 02:14:44,640 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:14:44,640 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:14:44,640 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:14:44,640 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:14:44,640 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:14:44,640 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:14:44,641 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:14:44,641 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:14:44,641 [DEBUG] server.py:456 - Tool cache miss for list-all-tables, refreshing cache
2025-12-03 02:14:44,641 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,641 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,641 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,641 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,641 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,671 [DEBUG] server.py:723 - Response sent
2025-12-03 02:14:44,672 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:14:43 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'a467294ab7544ee484e97101ff1f4aee'), (b'content-length', b'86075')])
2025-12-03 02:14:44,672 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:14:44,672 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:14:44,673 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:14:44,673 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:14:44,673 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:14:44,673 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:14:44,674 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:14:44,674 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:14:44,674 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:14:44,674 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:14:44,674 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:14:44,674 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:14:44,674 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:14:44,674 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:14:44,675 [DEBUG] server.py:723 - Response sent
2025-12-03 02:14:44,675 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:14:43 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'a467294ab7544ee484e97101ff1f4aee'), (b'content-length', b'3119')])
2025-12-03 02:14:44,676 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:14:44,676 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:14:44,676 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:14:44,676 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:14:44,676 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:14:44,677 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'DELETE']>
2025-12-03 02:14:44,677 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:14:44,677 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'DELETE']>
2025-12-03 02:14:44,677 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:14:44,677 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'DELETE']>
2025-12-03 02:14:44,677 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:14:44,677 [INFO] streamable_http.py:646 - Terminating session: a467294ab7544ee484e97101ff1f4aee
2025-12-03 02:14:44,678 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:14:43 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'a467294ab7544ee484e97101ff1f4aee'), (b'content-length', b'0')])
2025-12-03 02:14:44,678 [INFO] _client.py:1740 - HTTP Request: DELETE http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'DELETE']>
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:14:44,678 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - receive_response_body.failed exception=CancelledError("Cancelled via cancel scope 10eeed0f0 by <Task pending name='Task-31' coro=<Client._session_runner() running at /Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py:480> cb=[Task.task_wakeup()]>")
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:14:44,678 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:14:44,680 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:15:14 +03)" executed successfully
2025-12-03 02:15:13,286 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:15:13,286 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 5d9b9865c1ad430cb9e31ffd0db22eac
2025-12-03 02:15:14,609 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:15:14,610 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:15:44.607969+03:00 (in 29.997976 seconds)
2025-12-03 02:15:14,610 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:15:44 +03)" (scheduled at 2025-12-03 02:15:14.607969+03:00)
2025-12-03 02:15:14,610 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:15:14,611 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:15:14,625 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:15:14,627 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:15:14,630 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10efdb360>
2025-12-03 02:15:14,631 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:15:14,631 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:14,631 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:15:14,631 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:14,631 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:15:14,631 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:15:14,632 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 87e5e61b7a6a40f4a3d4ad15aa58d3f1
2025-12-03 02:15:14,634 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'87e5e61b7a6a40f4a3d4ad15aa58d3f1'), (b'content-length', b'422')])
2025-12-03 02:15:14,634 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:14,634 [INFO] streamable_http.py:134 - Received session ID: 87e5e61b7a6a40f4a3d4ad15aa58d3f1
2025-12-03 02:15:14,634 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:15:14,634 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:15:14,634 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:14,634 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:14,635 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:15:14,635 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:15:14,636 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:15:14,636 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:14,636 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:15:14,636 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:15:14,637 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:14,637 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:15:14,637 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:14,638 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:15:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'87e5e61b7a6a40f4a3d4ad15aa58d3f1'), (b'content-length', b'0')])
2025-12-03 02:15:14,638 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:15:14,638 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:15:14,638 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:14,638 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:14,638 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:15:14,639 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:15:14,640 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ecc7e10>
2025-12-03 02:15:14,640 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'GET']>
2025-12-03 02:15:14,640 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:14,640 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'GET']>
2025-12-03 02:15:14,640 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:14,640 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'GET']>
2025-12-03 02:15:14,641 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:14,641 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:14 GMT'), (b'server', b'uvicorn'), (b'cache-control', b'no-cache, no-transform'), (b'connection', b'keep-alive'), (b'content-type', b'text/event-stream'), (b'mcp-session-id', b'87e5e61b7a6a40f4a3d4ad15aa58d3f1'), (b'x-accel-buffering', b'no'), (b'transfer-encoding', b'chunked')])
2025-12-03 02:15:14,642 [INFO] _client.py:1740 - HTTP Request: GET http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:14,642 [DEBUG] streamable_http.py:212 - GET SSE connection established
2025-12-03 02:15:14,642 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'GET']>
2025-12-03 02:15:14,643 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10efd1eb0>
2025-12-03 02:15:14,643 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:15:14,643 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:14,643 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:15:14,643 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:14,643 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:15:14,643 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:14,644 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:15:14,644 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:15:14,644 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,651 [DEBUG] server.py:723 - Response sent
2025-12-03 02:15:14,651 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'87e5e61b7a6a40f4a3d4ad15aa58d3f1'), (b'content-length', b'86075')])
2025-12-03 02:15:14,652 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:14,652 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:15:14,652 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:15:14,652 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:14,652 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:14,653 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:15:14,653 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:15:14,653 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:14,653 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:15:14,654 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:14,654 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:15:14,654 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:14,654 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:15:14,654 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,655 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:14,656 [DEBUG] server.py:723 - Response sent
2025-12-03 02:15:14,656 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'87e5e61b7a6a40f4a3d4ad15aa58d3f1'), (b'content-length', b'3119')])
2025-12-03 02:15:14,656 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:14,656 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:15:14,656 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:15:14,656 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:14,656 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:14,661 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'DELETE']>
2025-12-03 02:15:14,661 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:14,661 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'DELETE']>
2025-12-03 02:15:14,661 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:14,661 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'DELETE']>
2025-12-03 02:15:14,661 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:14,661 [INFO] streamable_http.py:646 - Terminating session: 87e5e61b7a6a40f4a3d4ad15aa58d3f1
2025-12-03 02:15:14,661 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:15:14,662 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:14 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'87e5e61b7a6a40f4a3d4ad15aa58d3f1'), (b'content-length', b'0')])
2025-12-03 02:15:14,662 [INFO] _client.py:1740 - HTTP Request: DELETE http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:14,662 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'DELETE']>
2025-12-03 02:15:14,662 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:15:14,662 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:14,662 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:14,662 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:15:14,662 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:15:14,662 [DEBUG] _trace.py:87 - receive_response_body.failed exception=CancelledError("Cancelled via cancel scope 10ef6aed0 by <Task pending name='Task-109' coro=<Client._session_runner() running at /Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py:480> cb=[Task.task_wakeup()]>")
2025-12-03 02:15:14,662 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:14,662 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:15:14,663 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:15:14,663 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:14,663 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:15:14,664 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:15:44 +03)" executed successfully
2025-12-03 02:15:44,609 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:15:44,610 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:16:14.607969+03:00 (in 29.997871 seconds)
2025-12-03 02:15:44,610 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:16:14 +03)" (scheduled at 2025-12-03 02:15:44.607969+03:00)
2025-12-03 02:15:44,610 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:15:44,611 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:15:44,620 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:15:44,621 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:15:44,624 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ef6dae0>
2025-12-03 02:15:44,624 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:15:44,624 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:44,625 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:15:44,625 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:44,625 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:15:44,625 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:15:44,625 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: aa096631fe45486b97898182b081b336
2025-12-03 02:15:44,627 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'aa096631fe45486b97898182b081b336'), (b'content-length', b'422')])
2025-12-03 02:15:44,627 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:44,627 [INFO] streamable_http.py:134 - Received session ID: aa096631fe45486b97898182b081b336
2025-12-03 02:15:44,628 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:15:44,628 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:15:44,628 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:44,628 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:44,628 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:15:44,628 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:15:44,629 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:15:44,629 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:44,629 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:15:44,630 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:15:44,630 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:44,630 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:15:44,630 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:44,631 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:15:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'aa096631fe45486b97898182b081b336'), (b'content-length', b'0')])
2025-12-03 02:15:44,631 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:15:44,631 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:15:44,631 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:44,631 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:44,632 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:15:44,632 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:15:44,633 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10ee127a0>
2025-12-03 02:15:44,633 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'GET']>
2025-12-03 02:15:44,633 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:44,633 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'GET']>
2025-12-03 02:15:44,633 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:44,633 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'GET']>
2025-12-03 02:15:44,633 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:44,634 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:44 GMT'), (b'server', b'uvicorn'), (b'cache-control', b'no-cache, no-transform'), (b'connection', b'keep-alive'), (b'content-type', b'text/event-stream'), (b'mcp-session-id', b'aa096631fe45486b97898182b081b336'), (b'x-accel-buffering', b'no'), (b'transfer-encoding', b'chunked')])
2025-12-03 02:15:44,634 [INFO] _client.py:1740 - HTTP Request: GET http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:44,634 [DEBUG] streamable_http.py:212 - GET SSE connection established
2025-12-03 02:15:44,634 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'GET']>
2025-12-03 02:15:44,634 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10efbee50>
2025-12-03 02:15:44,635 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:15:44,635 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:44,635 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:15:44,635 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:44,635 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:15:44,635 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:44,635 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:15:44,635 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:15:44,636 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,639 [DEBUG] server.py:723 - Response sent
2025-12-03 02:15:44,639 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'aa096631fe45486b97898182b081b336'), (b'content-length', b'86075')])
2025-12-03 02:15:44,639 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:44,640 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:15:44,640 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:15:44,640 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:44,640 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:44,640 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:15:44,641 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:15:44,641 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:44,641 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:15:44,641 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:44,641 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:15:44,641 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:44,641 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:15:44,641 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:15:44,642 [DEBUG] server.py:723 - Response sent
2025-12-03 02:15:44,643 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'aa096631fe45486b97898182b081b336'), (b'content-length', b'3119')])
2025-12-03 02:15:44,643 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:44,643 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:15:44,643 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:15:44,643 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:44,643 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:44,645 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'DELETE']>
2025-12-03 02:15:44,645 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:15:44,645 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'DELETE']>
2025-12-03 02:15:44,645 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:15:44,645 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'DELETE']>
2025-12-03 02:15:44,645 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:15:44,645 [INFO] streamable_http.py:646 - Terminating session: aa096631fe45486b97898182b081b336
2025-12-03 02:15:44,646 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:15:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'aa096631fe45486b97898182b081b336'), (b'content-length', b'0')])
2025-12-03 02:15:44,646 [INFO] _client.py:1740 - HTTP Request: DELETE http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'DELETE']>
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:44,646 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - receive_response_body.failed exception=CancelledError("Cancelled via cancel scope 10ef6ab10 by <Task pending name='Task-154' coro=<Client._session_runner() running at /Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py:480> cb=[Task.task_wakeup()]>")
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:15:44,646 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:15:44,647 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:15:44,647 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:15:44,648 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:16:14 +03)" executed successfully
2025-12-03 02:16:14,609 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:16:14,609 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:16:44.607969+03:00 (in 29.998245 seconds)
2025-12-03 02:16:14,609 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:16:44 +03)" (scheduled at 2025-12-03 02:16:14.607969+03:00)
2025-12-03 02:16:14,610 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:16:14,610 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:16:14,620 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:16:14,621 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:16:14,624 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10efbe450>
2025-12-03 02:16:14,624 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:16:14,625 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:14,625 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:16:14,625 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:14,625 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:16:14,626 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:16:14,626 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 2c64c1c4513f429b9c0a6e02738a5c7e
2025-12-03 02:16:14,628 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:13 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'2c64c1c4513f429b9c0a6e02738a5c7e'), (b'content-length', b'422')])
2025-12-03 02:16:14,629 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:14,629 [INFO] streamable_http.py:134 - Received session ID: 2c64c1c4513f429b9c0a6e02738a5c7e
2025-12-03 02:16:14,629 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:16:14,629 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:16:14,629 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:14,629 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:14,630 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:16:14,630 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:16:14,631 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:16:14,631 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:14,631 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:16:14,631 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:16:14,631 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:14,631 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:16:14,632 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:14,632 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:16:13 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'2c64c1c4513f429b9c0a6e02738a5c7e'), (b'content-length', b'0')])
2025-12-03 02:16:14,632 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:16:14,632 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:16:14,633 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:14,633 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:14,633 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:16:14,634 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:16:14,635 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f063f20>
2025-12-03 02:16:14,636 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'GET']>
2025-12-03 02:16:14,636 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:14,636 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'GET']>
2025-12-03 02:16:14,636 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:14,636 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'GET']>
2025-12-03 02:16:14,636 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:14,639 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:13 GMT'), (b'server', b'uvicorn'), (b'cache-control', b'no-cache, no-transform'), (b'connection', b'keep-alive'), (b'content-type', b'text/event-stream'), (b'mcp-session-id', b'2c64c1c4513f429b9c0a6e02738a5c7e'), (b'x-accel-buffering', b'no'), (b'transfer-encoding', b'chunked')])
2025-12-03 02:16:14,639 [INFO] _client.py:1740 - HTTP Request: GET http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:14,639 [DEBUG] streamable_http.py:212 - GET SSE connection established
2025-12-03 02:16:14,639 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'GET']>
2025-12-03 02:16:14,639 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10eff3980>
2025-12-03 02:16:14,639 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:16:14,640 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:14,640 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:16:14,640 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:14,640 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:16:14,640 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:14,640 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:16:14,640 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:16:14,641 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,646 [DEBUG] server.py:723 - Response sent
2025-12-03 02:16:14,647 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:13 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'2c64c1c4513f429b9c0a6e02738a5c7e'), (b'content-length', b'86075')])
2025-12-03 02:16:14,647 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:14,647 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:16:14,647 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:16:14,647 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:14,647 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:14,648 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:16:14,648 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:16:14,649 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:14,649 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:16:14,649 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:14,649 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:16:14,649 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:14,650 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:16:14,650 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:16:14,650 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,650 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,650 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,650 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,651 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,651 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,651 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,651 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,651 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,651 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:14,651 [DEBUG] server.py:723 - Response sent
2025-12-03 02:16:14,652 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:13 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'2c64c1c4513f429b9c0a6e02738a5c7e'), (b'content-length', b'3119')])
2025-12-03 02:16:14,652 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:14,652 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:16:14,652 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:16:14,652 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:14,652 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:14,655 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'DELETE']>
2025-12-03 02:16:14,655 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:14,655 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'DELETE']>
2025-12-03 02:16:14,655 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:14,655 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'DELETE']>
2025-12-03 02:16:14,656 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:14,656 [INFO] streamable_http.py:646 - Terminating session: 2c64c1c4513f429b9c0a6e02738a5c7e
2025-12-03 02:16:14,656 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:16:14,656 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:13 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'2c64c1c4513f429b9c0a6e02738a5c7e'), (b'content-length', b'0')])
2025-12-03 02:16:14,656 [INFO] _client.py:1740 - HTTP Request: DELETE http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:14,656 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'DELETE']>
2025-12-03 02:16:14,656 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:16:14,656 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:14,657 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:14,657 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:16:14,657 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:16:14,657 [DEBUG] _trace.py:87 - receive_response_body.failed exception=CancelledError("Cancelled via cancel scope 10ef6b890 by <Task pending name='Task-199' coro=<Client._session_runner() running at /Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py:480> cb=[Task.task_wakeup()]>")
2025-12-03 02:16:14,657 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:14,657 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:16:14,657 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:16:14,658 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:14,658 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:16:14,660 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:16:44 +03)" executed successfully
2025-12-03 02:16:15,099 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:16:15,099 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: f52ec4c23bc34406a91e2e3d6969908b
2025-12-03 02:16:15,121 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:15,123 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:19,052 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:19,052 [INFO] streamable_http.py:646 - Terminating session: f52ec4c23bc34406a91e2e3d6969908b
2025-12-03 02:16:19,053 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:16:19,054 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:16:22,025 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:16:22,025 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: af32cdc081a54008b613e20897834b57
2025-12-03 02:16:27,026 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:16:27,027 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 1697e57e485346c890672e7cef473020
2025-12-03 02:16:27,045 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:27,049 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:42,052 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:16:42.052315+00:00\r\n\r\n'
2025-12-03 02:16:44,609 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:16:44,609 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:17:14.607969+03:00 (in 29.998200 seconds)
2025-12-03 02:16:44,610 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:17:14 +03)" (scheduled at 2025-12-03 02:16:44.607969+03:00)
2025-12-03 02:16:44,610 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:16:44,611 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:16:44,624 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:16:44,625 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:16:44,628 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f0c52b0>
2025-12-03 02:16:44,629 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:16:44,629 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:44,629 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:16:44,629 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:44,630 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:16:44,630 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:16:44,631 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 16d0c8d0a8454ff096f8a638d0097d02
2025-12-03 02:16:44,632 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'16d0c8d0a8454ff096f8a638d0097d02'), (b'content-length', b'422')])
2025-12-03 02:16:44,632 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:44,633 [INFO] streamable_http.py:134 - Received session ID: 16d0c8d0a8454ff096f8a638d0097d02
2025-12-03 02:16:44,633 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:16:44,633 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:16:44,633 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:44,633 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:44,633 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:16:44,634 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:16:44,635 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:16:44,636 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:44,636 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:16:44,636 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:16:44,636 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:44,636 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:16:44,637 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:44,637 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:16:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'16d0c8d0a8454ff096f8a638d0097d02'), (b'content-length', b'0')])
2025-12-03 02:16:44,638 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:16:44,638 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:16:44,638 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:44,638 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:44,638 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:16:44,639 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:16:44,640 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f0c7310>
2025-12-03 02:16:44,640 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'GET']>
2025-12-03 02:16:44,640 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:44,640 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'GET']>
2025-12-03 02:16:44,640 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:44,640 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'GET']>
2025-12-03 02:16:44,641 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:44,643 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:44 GMT'), (b'server', b'uvicorn'), (b'cache-control', b'no-cache, no-transform'), (b'connection', b'keep-alive'), (b'content-type', b'text/event-stream'), (b'mcp-session-id', b'16d0c8d0a8454ff096f8a638d0097d02'), (b'x-accel-buffering', b'no'), (b'transfer-encoding', b'chunked')])
2025-12-03 02:16:44,643 [INFO] _client.py:1740 - HTTP Request: GET http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:44,643 [DEBUG] streamable_http.py:212 - GET SSE connection established
2025-12-03 02:16:44,643 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'GET']>
2025-12-03 02:16:44,643 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10f0793d0>
2025-12-03 02:16:44,643 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:16:44,644 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:44,644 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:16:44,644 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:44,644 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:16:44,644 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:44,644 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:16:44,645 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:16:44,645 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,650 [DEBUG] server.py:723 - Response sent
2025-12-03 02:16:44,651 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'16d0c8d0a8454ff096f8a638d0097d02'), (b'content-length', b'86075')])
2025-12-03 02:16:44,651 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:44,651 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:16:44,651 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:16:44,651 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:44,652 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:44,652 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:16:44,653 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:16:44,653 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:44,653 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:16:44,653 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:44,653 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:16:44,653 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:44,653 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:16:44,653 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,654 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:16:44,655 [DEBUG] server.py:723 - Response sent
2025-12-03 02:16:44,655 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'16d0c8d0a8454ff096f8a638d0097d02'), (b'content-length', b'3119')])
2025-12-03 02:16:44,655 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:44,655 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:16:44,655 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:16:44,655 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:44,655 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:44,657 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'DELETE']>
2025-12-03 02:16:44,658 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:16:44,658 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'DELETE']>
2025-12-03 02:16:44,658 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:16:44,658 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'DELETE']>
2025-12-03 02:16:44,658 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:16:44,658 [INFO] streamable_http.py:646 - Terminating session: 16d0c8d0a8454ff096f8a638d0097d02
2025-12-03 02:16:44,658 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:16:44,658 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:16:44 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'16d0c8d0a8454ff096f8a638d0097d02'), (b'content-length', b'0')])
2025-12-03 02:16:44,659 [INFO] _client.py:1740 - HTTP Request: DELETE http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'DELETE']>
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:44,659 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - receive_response_body.failed exception=CancelledError("Cancelled via cancel scope 10f066690 by <Task pending name='Task-254' coro=<Client._session_runner() running at /Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py:480> cb=[Task.task_wakeup()]>")
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:16:44,659 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:16:44,661 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:17:14 +03)" executed successfully
2025-12-03 02:16:57,054 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:16:57.054514+00:00\r\n\r\n'
2025-12-03 02:17:09,797 [DEBUG] selector_events.py:64 - Using selector: KqueueSelector
2025-12-03 02:17:09,797 [INFO] main.py:10 - Started
2025-12-03 02:17:09,797 [INFO] mcp_server.py:134 - Starting MCP Database Server...
2025-12-03 02:17:09,797 [DEBUG] server.py:157 - Initializing server 'DBMCPServer ðŸš€'
2025-12-03 02:17:09,797 [DEBUG] server.py:414 - Registering handler for ListToolsRequest
2025-12-03 02:17:09,797 [DEBUG] server.py:281 - Registering handler for ListResourcesRequest
2025-12-03 02:17:09,797 [DEBUG] server.py:301 - Registering handler for ListResourceTemplatesRequest
2025-12-03 02:17:09,797 [DEBUG] server.py:243 - Registering handler for PromptListRequest
2025-12-03 02:17:09,797 [DEBUG] server.py:486 - Registering handler for CallToolRequest
2025-12-03 02:17:09,797 [DEBUG] server.py:316 - Registering handler for ReadResourceRequest
2025-12-03 02:17:09,797 [DEBUG] server.py:265 - Registering handler for GetPromptRequest
2025-12-03 02:17:09,803 [INFO] factory.py:76 - All fetchers initialized
2025-12-03 02:17:09,831 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 5
2025-12-03 02:17:09,860 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 13
2025-12-03 02:17:09,860 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 14
2025-12-03 02:17:09,863 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdarmutlu@localhost:5432/omdb [id=5]
2025-12-03 02:17:09,864 [INFO] postgresql_manager.py:39 - 5 is activated
2025-12-03 02:17:09,888 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: postgres@pg1:5432/demo [id=13]
2025-12-03 02:17:09,889 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdar@pg2:5432/Adventureworks [id=14]
2025-12-03 02:17:09,890 [INFO] postgresql_manager.py:39 - 13 is activated
2025-12-03 02:17:09,890 [INFO] postgresql_manager.py:39 - 14 is activated
2025-12-03 02:17:09,890 [INFO] postgresql_manager.py:66 - âœ… DB Manager initialized. Active pools: 3
2025-12-03 02:17:09,892 [INFO] base.py:507 - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-12-03 02:17:09,892 [INFO] metadata_scheduler_manager.py:170 - Loaded job: Test2
2025-12-03 02:17:09,893 [INFO] base.py:1090 - Added job "SchedulerManager.execute_job" to job store "default"
2025-12-03 02:17:09,893 [INFO] base.py:214 - Scheduler started
2025-12-03 02:17:09,893 [INFO] metadata_scheduler_manager.py:175 - Scheduler started
2025-12-03 02:17:09,903 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:17:09,903 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:17:39.892720+03:00 (in 29.989318 seconds)
2025-12-03 02:17:09,903 [INFO] streamable_http_manager.py:110 - StreamableHTTP session manager started
2025-12-03 02:17:10,246 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:17:25,248 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:17:25.248183+00:00\r\n\r\n'
2025-12-03 02:17:39,894 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:17:39,894 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:18:09.892720+03:00 (in 29.998091 seconds)
2025-12-03 02:17:39,894 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:18:09 +03)" (scheduled at 2025-12-03 02:17:39.892720+03:00)
2025-12-03 02:17:39,894 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:17:39,895 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:17:39,926 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:17:39,927 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:17:39,929 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e324d70>
2025-12-03 02:17:39,929 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:17:39,930 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:17:39,930 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:17:39,930 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:17:39,930 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:17:39,930 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:17:39,931 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:17:39,931 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 02:17:39,932 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:17:39 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'422')])
2025-12-03 02:17:39,933 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:17:39,933 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:17:39,933 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:17:39,933 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:17:39,933 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:17:39,933 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:17:39,934 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:17:39,934 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:17:39,934 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:17:39,934 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:17:39,934 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:17:39,934 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:17:39,935 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:17:39,935 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:17:39,935 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:17:39 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'0')])
2025-12-03 02:17:39,935 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:17:39,936 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:17:39,936 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:17:39,936 [DEBUG] session.py:426 - Read stream closed by client
2025-12-03 02:17:39,936 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:17:39,936 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:17:39,936 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:17:39,937 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e30c2d0>
2025-12-03 02:17:39,938 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:17:39,938 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:17:39,938 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:17:39,938 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:17:39,938 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:17:39,938 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:17:39,938 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:17:39,938 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:17:39,938 [DEBUG] server.py:456 - Tool cache miss for list-all-tables, refreshing cache
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,939 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,972 [DEBUG] server.py:723 - Response sent
2025-12-03 02:17:39,973 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:17:39,973 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 02:17:39,974 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:17:39 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 02:17:39,974 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:17:39,974 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:17:39,974 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:17:39,974 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:17:39,974 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:17:39,975 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:17:39,975 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:17:39,975 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:17:39,975 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:17:39,976 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:17:39,976 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:17:39,976 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:17:39,976 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:17:39,976 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:17:39,977 [DEBUG] server.py:723 - Response sent
2025-12-03 02:17:39,977 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:17:39,977 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 02:17:39,978 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:17:39 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'3119')])
2025-12-03 02:17:39,978 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:17:39,978 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:17:39,978 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:17:39,978 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:17:39,978 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:17:39,979 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:17:39,979 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:17:39,981 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:18:09 +03)" executed successfully
2025-12-03 02:17:40,250 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:17:40.250401+00:00\r\n\r\n'
2025-12-03 02:17:55,251 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:17:55.251887+00:00\r\n\r\n'
2025-12-03 02:18:09,894 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:18:09,894 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:18:39.892720+03:00 (in 29.998062 seconds)
2025-12-03 02:18:09,895 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:18:39 +03)" (scheduled at 2025-12-03 02:18:09.892720+03:00)
2025-12-03 02:18:09,895 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:18:09,896 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:18:09,910 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:18:09,911 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:18:09,914 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e3e42d0>
2025-12-03 02:18:09,915 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:18:09,915 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:18:09,915 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:18:09,915 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:18:09,916 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:18:09,916 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:18:09,918 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:18:09,918 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 02:18:09,920 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:18:09 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'422')])
2025-12-03 02:18:09,920 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:18:09,921 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:18:09,921 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:18:09,921 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:18:09,921 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:18:09,922 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:18:09,923 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:18:09,923 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:18:09,924 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:18:09,924 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:18:09,924 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:18:09,924 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:18:09,924 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:18:09,925 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:18:09,925 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:18:09 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'0')])
2025-12-03 02:18:09,926 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:18:09,926 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:18:09,926 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:18:09,926 [DEBUG] session.py:426 - Read stream closed by client
2025-12-03 02:18:09,926 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:18:09,926 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:18:09,927 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:18:09,929 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e2bfe10>
2025-12-03 02:18:09,929 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:18:09,929 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:18:09,929 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:18:09,930 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:18:09,930 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:18:09,930 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:18:09,931 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:18:09,931 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:18:09,931 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,937 [DEBUG] server.py:723 - Response sent
2025-12-03 02:18:09,938 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:18:09,938 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 02:18:09,939 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:18:09 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'86075')])
2025-12-03 02:18:09,939 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:18:09,939 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:18:09,940 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:18:09,940 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:18:09,940 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:18:09,941 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:18:09,941 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:18:09,941 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:18:09,941 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:18:09,941 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:18:09,941 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:18:09,942 [DEBUG] streamable_http_manager.py:160 - Stateless mode: Creating new transport for this request
2025-12-03 02:18:09,942 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:18:09,942 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:18:09,943 [DEBUG] server.py:723 - Response sent
2025-12-03 02:18:09,944 [INFO] streamable_http.py:646 - Terminating session: None
2025-12-03 02:18:09,944 [ERROR] streamable_http.py:895 - Error in message router
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/server/streamable_http.py", line 847, in message_router
    async for session_message in write_stream_reader:
    ...<45 lines>...
            )
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/abc/_streams.py", line 41, in __anext__
    return await self.receive()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 111, in receive
    return self.receive_nowait()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise ClosedResourceError
anyio.ClosedResourceError
2025-12-03 02:18:09,945 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:18:09 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'content-length', b'3119')])
2025-12-03 02:18:09,945 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:18:09,945 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:18:09,945 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:18:09,945 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:18:09,945 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:18:09,950 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:18:09,950 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:18:09,952 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:18:39 +03)" executed successfully
2025-12-03 02:18:10,253 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:18:10.253795+00:00\r\n\r\n'
2025-12-03 02:20:50,026 [DEBUG] selector_events.py:64 - Using selector: KqueueSelector
2025-12-03 02:20:50,026 [INFO] main.py:10 - Started
2025-12-03 02:20:50,026 [INFO] mcp_server.py:134 - Starting MCP Database Server...
2025-12-03 02:20:50,026 [DEBUG] server.py:157 - Initializing server 'DBMCPServer ðŸš€'
2025-12-03 02:20:50,026 [DEBUG] server.py:414 - Registering handler for ListToolsRequest
2025-12-03 02:20:50,026 [DEBUG] server.py:281 - Registering handler for ListResourcesRequest
2025-12-03 02:20:50,027 [DEBUG] server.py:301 - Registering handler for ListResourceTemplatesRequest
2025-12-03 02:20:50,027 [DEBUG] server.py:243 - Registering handler for PromptListRequest
2025-12-03 02:20:50,027 [DEBUG] server.py:486 - Registering handler for CallToolRequest
2025-12-03 02:20:50,027 [DEBUG] server.py:316 - Registering handler for ReadResourceRequest
2025-12-03 02:20:50,027 [DEBUG] server.py:265 - Registering handler for GetPromptRequest
2025-12-03 02:20:50,033 [INFO] factory.py:76 - All fetchers initialized
2025-12-03 02:20:50,061 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 5
2025-12-03 02:20:50,089 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 13
2025-12-03 02:20:50,090 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 14
2025-12-03 02:20:50,093 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdarmutlu@localhost:5432/omdb [id=5]
2025-12-03 02:20:50,096 [INFO] postgresql_manager.py:39 - 5 is activated
2025-12-03 02:20:50,119 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: postgres@pg1:5432/demo [id=13]
2025-12-03 02:20:50,120 [INFO] postgresql_manager.py:39 - 13 is activated
2025-12-03 02:20:50,123 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdar@pg2:5432/Adventureworks [id=14]
2025-12-03 02:20:50,124 [INFO] postgresql_manager.py:39 - 14 is activated
2025-12-03 02:20:50,124 [INFO] postgresql_manager.py:66 - âœ… DB Manager initialized. Active pools: 3
2025-12-03 02:20:50,125 [INFO] base.py:507 - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-12-03 02:20:50,125 [INFO] metadata_scheduler_manager.py:170 - Loaded job: Test2
2025-12-03 02:20:50,125 [INFO] base.py:1090 - Added job "SchedulerManager.execute_job" to job store "default"
2025-12-03 02:20:50,125 [INFO] base.py:214 - Scheduler started
2025-12-03 02:20:50,125 [INFO] metadata_scheduler_manager.py:175 - Scheduler started
2025-12-03 02:20:50,136 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:20:50,136 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:21:20.125228+03:00 (in 29.988455 seconds)
2025-12-03 02:20:50,136 [INFO] streamable_http_manager.py:110 - StreamableHTTP session manager started
2025-12-03 02:21:20,126 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:21:20,127 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:21:50.125228+03:00 (in 29.997648 seconds)
2025-12-03 02:21:20,127 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:21:50 +03)" (scheduled at 2025-12-03 02:21:20.125228+03:00)
2025-12-03 02:21:20,127 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:21:20,128 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:21:20,152 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:21:20,152 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:21:20,155 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e4bbcb0>
2025-12-03 02:21:20,155 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:21:20,155 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:20,155 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:21:20,155 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:20,156 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:21:20,156 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:21:20,156 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: bb7add75430741fb98075ba3a22da1c7
2025-12-03 02:21:20,157 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:19 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'bb7add75430741fb98075ba3a22da1c7'), (b'content-length', b'422')])
2025-12-03 02:21:20,157 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:20,157 [INFO] streamable_http.py:134 - Received session ID: bb7add75430741fb98075ba3a22da1c7
2025-12-03 02:21:20,158 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:21:20,158 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:21:20,158 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:20,158 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:20,158 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:21:20,158 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:21:20,159 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:21:20,159 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:20,159 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:21:20,159 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:21:20,159 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:20,159 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:21:20,160 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:20,160 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:21:19 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'bb7add75430741fb98075ba3a22da1c7'), (b'content-length', b'0')])
2025-12-03 02:21:20,160 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:21:20,160 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:21:20,160 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:20,160 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:20,161 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:21:20,161 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:21:20,162 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e57a210>
2025-12-03 02:21:20,162 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'GET']>
2025-12-03 02:21:20,162 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:20,162 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'GET']>
2025-12-03 02:21:20,162 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:20,162 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'GET']>
2025-12-03 02:21:20,162 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:20,163 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:19 GMT'), (b'server', b'uvicorn'), (b'cache-control', b'no-cache, no-transform'), (b'connection', b'keep-alive'), (b'content-type', b'text/event-stream'), (b'mcp-session-id', b'bb7add75430741fb98075ba3a22da1c7'), (b'x-accel-buffering', b'no'), (b'transfer-encoding', b'chunked')])
2025-12-03 02:21:20,163 [INFO] _client.py:1740 - HTTP Request: GET http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:20,163 [DEBUG] streamable_http.py:212 - GET SSE connection established
2025-12-03 02:21:20,163 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'GET']>
2025-12-03 02:21:20,164 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e4539d0>
2025-12-03 02:21:20,164 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:21:20,164 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:20,164 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:21:20,164 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:20,164 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:21:20,164 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:20,165 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:21:20,165 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:21:20,165 [DEBUG] server.py:456 - Tool cache miss for list-all-tables, refreshing cache
2025-12-03 02:21:20,165 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,165 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,165 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,166 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,166 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,166 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,166 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,166 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,166 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,166 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,166 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,198 [DEBUG] server.py:723 - Response sent
2025-12-03 02:21:20,199 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:19 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'bb7add75430741fb98075ba3a22da1c7'), (b'content-length', b'86075')])
2025-12-03 02:21:20,199 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:20,199 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:21:20,199 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:21:20,199 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:20,200 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:20,201 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:21:20,201 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:21:20,201 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:20,201 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:21:20,201 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:20,201 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:21:20,201 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:20,202 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:21:20,202 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,202 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:20,203 [DEBUG] server.py:723 - Response sent
2025-12-03 02:21:20,203 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:19 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'bb7add75430741fb98075ba3a22da1c7'), (b'content-length', b'3119')])
2025-12-03 02:21:20,203 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:20,203 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:21:20,203 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:21:20,203 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:20,203 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:20,205 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'DELETE']>
2025-12-03 02:21:20,205 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:20,205 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'DELETE']>
2025-12-03 02:21:20,205 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:20,205 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'DELETE']>
2025-12-03 02:21:20,206 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:20,206 [INFO] streamable_http.py:646 - Terminating session: bb7add75430741fb98075ba3a22da1c7
2025-12-03 02:21:20,206 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:21:20,206 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:19 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'bb7add75430741fb98075ba3a22da1c7'), (b'content-length', b'0')])
2025-12-03 02:21:20,206 [INFO] _client.py:1740 - HTTP Request: DELETE http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:20,206 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'DELETE']>
2025-12-03 02:21:20,206 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:21:20,206 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:20,206 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:20,206 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:21:20,206 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:21:20,207 [DEBUG] _trace.py:87 - receive_response_body.failed exception=CancelledError("Cancelled via cancel scope 10e480d60 by <Task pending name='Task-31' coro=<Client._session_runner() running at /Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py:480> cb=[Task.task_wakeup()]>")
2025-12-03 02:21:20,207 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:20,207 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:21:20,207 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:21:20,207 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:20,207 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:21:20,209 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:21:50 +03)" executed successfully
2025-12-03 02:21:50,126 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:21:50,127 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:22:20.125228+03:00 (in 29.998229 seconds)
2025-12-03 02:21:50,127 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:22:20 +03)" (scheduled at 2025-12-03 02:21:50.125228+03:00)
2025-12-03 02:21:50,127 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:21:50,127 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:21:50,138 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:21:50,139 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:21:50,142 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e56e2c0>
2025-12-03 02:21:50,142 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:21:50,143 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:50,143 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:21:50,143 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:50,143 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:21:50,143 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:21:50,143 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: c93b39ed518946e4b38a258025cb869a
2025-12-03 02:21:50,145 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'c93b39ed518946e4b38a258025cb869a'), (b'content-length', b'422')])
2025-12-03 02:21:50,145 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:50,145 [INFO] streamable_http.py:134 - Received session ID: c93b39ed518946e4b38a258025cb869a
2025-12-03 02:21:50,145 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:21:50,145 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:21:50,145 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:50,145 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:50,146 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:21:50,146 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:21:50,147 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:21:50,147 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:50,147 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:21:50,147 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:21:50,147 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:50,147 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:21:50,147 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:50,148 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:21:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'c93b39ed518946e4b38a258025cb869a'), (b'content-length', b'0')])
2025-12-03 02:21:50,148 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:21:50,148 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:21:50,148 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:50,149 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:50,149 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:21:50,149 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:21:50,150 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e257e10>
2025-12-03 02:21:50,151 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'GET']>
2025-12-03 02:21:50,151 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:50,151 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'GET']>
2025-12-03 02:21:50,151 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:50,151 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'GET']>
2025-12-03 02:21:50,151 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:50,152 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:49 GMT'), (b'server', b'uvicorn'), (b'cache-control', b'no-cache, no-transform'), (b'connection', b'keep-alive'), (b'content-type', b'text/event-stream'), (b'mcp-session-id', b'c93b39ed518946e4b38a258025cb869a'), (b'x-accel-buffering', b'no'), (b'transfer-encoding', b'chunked')])
2025-12-03 02:21:50,152 [INFO] _client.py:1740 - HTTP Request: GET http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:50,152 [DEBUG] streamable_http.py:212 - GET SSE connection established
2025-12-03 02:21:50,152 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'GET']>
2025-12-03 02:21:50,152 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e5632f0>
2025-12-03 02:21:50,152 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:21:50,153 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:50,153 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:21:50,153 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:50,153 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:21:50,153 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:50,153 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:21:50,153 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:21:50,154 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,160 [DEBUG] server.py:723 - Response sent
2025-12-03 02:21:50,161 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'c93b39ed518946e4b38a258025cb869a'), (b'content-length', b'86075')])
2025-12-03 02:21:50,161 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:50,161 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:21:50,161 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:21:50,161 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:50,161 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:50,162 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:21:50,163 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:21:50,163 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:50,163 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:21:50,163 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:50,163 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:21:50,163 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:50,164 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:21:50,164 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:21:50,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,165 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:21:50,165 [DEBUG] server.py:723 - Response sent
2025-12-03 02:21:50,165 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'c93b39ed518946e4b38a258025cb869a'), (b'content-length', b'3119')])
2025-12-03 02:21:50,165 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:50,165 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:21:50,166 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:21:50,166 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:50,166 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:50,172 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'DELETE']>
2025-12-03 02:21:50,172 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:21:50,172 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'DELETE']>
2025-12-03 02:21:50,172 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:21:50,172 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'DELETE']>
2025-12-03 02:21:50,172 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:21:50,172 [INFO] streamable_http.py:646 - Terminating session: c93b39ed518946e4b38a258025cb869a
2025-12-03 02:21:50,173 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:21:50,173 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:21:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'c93b39ed518946e4b38a258025cb869a'), (b'content-length', b'0')])
2025-12-03 02:21:50,173 [INFO] _client.py:1740 - HTTP Request: DELETE http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:21:50,173 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'DELETE']>
2025-12-03 02:21:50,173 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:21:50,173 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:50,173 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:21:50,173 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:50,174 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:21:50,174 [DEBUG] _trace.py:87 - receive_response_body.failed exception=CancelledError("Cancelled via cancel scope 10e4f6b10 by <Task pending name='Task-106' coro=<Client._session_runner() running at /Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py:480> cb=[Task.task_wakeup()]>")
2025-12-03 02:21:50,174 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:21:50,174 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:21:50,174 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:21:50,174 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:21:50,174 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:21:50,176 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:22:20 +03)" executed successfully
2025-12-03 02:22:03,964 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:22:03,964 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 4cac721776ab4d718d529773466ef53e
2025-12-03 02:22:03,977 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:03,979 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:08,734 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:22:08,734 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 7f36dc7ac7ee4cd0a68f48c954b589da
2025-12-03 02:22:09,582 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:22:09,583 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: b91dea4056ca486ca6b43d914df3c1c7
2025-12-03 02:22:10,271 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:22:10,271 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 707d6a7e23f2430ab7bfde8dbe4ec196
2025-12-03 02:22:13,352 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:22:13,353 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: bc6780513ecd42fab6b5d04fb6ad357f
2025-12-03 02:22:13,368 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:13,371 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:17,878 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:17,880 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:22:17,880 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: node-fetch
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: node-fetch
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: node-fetch
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: node-fetch
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: node-fetch
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: node-fetch
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: node-fetch
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: node-fetch
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: node-fetch
2025-12-03 02:22:17,882 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: node-fetch
2025-12-03 02:22:17,883 [DEBUG] server.py:723 - Response sent
2025-12-03 02:22:18,981 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:22:18.981045+00:00\r\n\r\n'
2025-12-03 02:22:20,126 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:22:20,126 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:22:50.125228+03:00 (in 29.998561 seconds)
2025-12-03 02:22:20,126 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:22:50 +03)" (scheduled at 2025-12-03 02:22:20.125228+03:00)
2025-12-03 02:22:20,127 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:22:20,127 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:22:20,139 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:22:20,139 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:22:20,142 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e4ff570>
2025-12-03 02:22:20,142 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:22:20,143 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:20,143 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:22:20,143 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:20,143 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:22:20,143 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:22:20,143 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 434259e4547a48c4a93fed040e80f3e4
2025-12-03 02:22:20,144 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:20 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'434259e4547a48c4a93fed040e80f3e4'), (b'content-length', b'422')])
2025-12-03 02:22:20,145 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:20,145 [INFO] streamable_http.py:134 - Received session ID: 434259e4547a48c4a93fed040e80f3e4
2025-12-03 02:22:20,145 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:22:20,145 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:22:20,145 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:20,145 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:20,145 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:22:20,146 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:22:20,146 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:22:20,147 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:20,147 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:22:20,147 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:22:20,147 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:20,147 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:22:20,148 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:20,148 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:22:20 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'434259e4547a48c4a93fed040e80f3e4'), (b'content-length', b'0')])
2025-12-03 02:22:20,148 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:22:20,149 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:22:20,149 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:20,149 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:20,149 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:22:20,150 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:22:20,151 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e39e690>
2025-12-03 02:22:20,151 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'GET']>
2025-12-03 02:22:20,151 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:20,151 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'GET']>
2025-12-03 02:22:20,151 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:20,151 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'GET']>
2025-12-03 02:22:20,152 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:20,152 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:20 GMT'), (b'server', b'uvicorn'), (b'cache-control', b'no-cache, no-transform'), (b'connection', b'keep-alive'), (b'content-type', b'text/event-stream'), (b'mcp-session-id', b'434259e4547a48c4a93fed040e80f3e4'), (b'x-accel-buffering', b'no'), (b'transfer-encoding', b'chunked')])
2025-12-03 02:22:20,152 [INFO] _client.py:1740 - HTTP Request: GET http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:20,152 [DEBUG] streamable_http.py:212 - GET SSE connection established
2025-12-03 02:22:20,152 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'GET']>
2025-12-03 02:22:20,153 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e54f950>
2025-12-03 02:22:20,153 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:22:20,153 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:20,153 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:22:20,153 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:20,153 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:22:20,153 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:20,154 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:22:20,154 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:22:20,154 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,160 [DEBUG] server.py:723 - Response sent
2025-12-03 02:22:20,161 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:20 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'434259e4547a48c4a93fed040e80f3e4'), (b'content-length', b'86075')])
2025-12-03 02:22:20,161 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:20,161 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:22:20,161 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:22:20,161 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:20,161 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:20,162 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:22:20,162 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:22:20,162 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:20,162 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:22:20,162 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:20,162 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:22:20,162 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:20,163 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:22:20,163 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:22:20,163 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,163 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,163 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,163 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,163 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,164 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:20,164 [DEBUG] server.py:723 - Response sent
2025-12-03 02:22:20,164 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:20 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'434259e4547a48c4a93fed040e80f3e4'), (b'content-length', b'3119')])
2025-12-03 02:22:20,164 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:20,164 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:22:20,165 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:22:20,165 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:20,165 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:20,170 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'DELETE']>
2025-12-03 02:22:20,170 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:20,170 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'DELETE']>
2025-12-03 02:22:20,170 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:20,170 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'DELETE']>
2025-12-03 02:22:20,170 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:20,170 [INFO] streamable_http.py:646 - Terminating session: 434259e4547a48c4a93fed040e80f3e4
2025-12-03 02:22:20,170 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:20 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'434259e4547a48c4a93fed040e80f3e4'), (b'content-length', b'0')])
2025-12-03 02:22:20,171 [INFO] _client.py:1740 - HTTP Request: DELETE http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'DELETE']>
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:20,171 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - receive_response_body.failed exception=CancelledError("Cancelled via cancel scope 10e4f5cd0 by <Task pending name='Task-195' coro=<Client._session_runner() running at /Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py:480> cb=[Task.task_wakeup()]>")
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:22:20,171 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:20,172 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:22:20,174 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:22:50 +03)" executed successfully
2025-12-03 02:22:26,098 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:26,099 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:22:26,099 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:22:26,100 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:Add | User-Agent: node-fetch
2025-12-03 02:22:26,103 [DEBUG] server.py:723 - Response sent
2025-12-03 02:22:28,373 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:22:28.373510+00:00\r\n\r\n'
2025-12-03 02:22:33,982 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:22:33.982537+00:00\r\n\r\n'
2025-12-03 02:22:43,374 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:22:43.374631+00:00\r\n\r\n'
2025-12-03 02:22:48,984 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:22:48.984227+00:00\r\n\r\n'
2025-12-03 02:22:50,126 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:22:50,127 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:23:20.125228+03:00 (in 29.998120 seconds)
2025-12-03 02:22:50,127 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:23:20 +03)" (scheduled at 2025-12-03 02:22:50.125228+03:00)
2025-12-03 02:22:50,127 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:22:50,127 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:22:50,137 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:22:50,137 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:22:50,139 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e54fb50>
2025-12-03 02:22:50,139 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:22:50,140 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:50,140 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:22:50,140 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:50,140 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:22:50,140 [DEBUG] streamable_http_manager.py:221 - Creating new transport
2025-12-03 02:22:50,140 [INFO] streamable_http_manager.py:233 - Created new transport with session ID: 71a78b76933347b99442de102ea9f3bd
2025-12-03 02:22:50,141 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'71a78b76933347b99442de102ea9f3bd'), (b'content-length', b'422')])
2025-12-03 02:22:50,141 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:50,141 [INFO] streamable_http.py:134 - Received session ID: 71a78b76933347b99442de102ea9f3bd
2025-12-03 02:22:50,141 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:22:50,141 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:22:50,141 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:50,142 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:50,142 [INFO] streamable_http.py:146 - Negotiated protocol version: 2025-06-18
2025-12-03 02:22:50,142 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-12-03 02:22:50,143 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:22:50,143 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:50,143 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:22:50,143 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:22:50,143 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:50,143 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:22:50,143 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:50,144 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 202, b'Accepted', [(b'date', b'Tue, 02 Dec 2025 23:22:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'71a78b76933347b99442de102ea9f3bd'), (b'content-length', b'0')])
2025-12-03 02:22:50,144 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 202 Accepted"
2025-12-03 02:22:50,144 [DEBUG] streamable_http.py:267 - Received 202 Accepted
2025-12-03 02:22:50,144 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:50,144 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:50,144 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/call', params={'name': 'list-all-tables', 'arguments': {'connection_id': 5}, '_meta': {'progressToken': 1}}, jsonrpc='2.0', id=1)
2025-12-03 02:22:50,144 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:22:50,146 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e5c0aa0>
2025-12-03 02:22:50,147 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'GET']>
2025-12-03 02:22:50,147 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:50,147 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'GET']>
2025-12-03 02:22:50,147 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:50,147 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'GET']>
2025-12-03 02:22:50,147 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:50,148 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:49 GMT'), (b'server', b'uvicorn'), (b'cache-control', b'no-cache, no-transform'), (b'connection', b'keep-alive'), (b'content-type', b'text/event-stream'), (b'mcp-session-id', b'71a78b76933347b99442de102ea9f3bd'), (b'x-accel-buffering', b'no'), (b'transfer-encoding', b'chunked')])
2025-12-03 02:22:50,148 [INFO] _client.py:1740 - HTTP Request: GET http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:50,148 [DEBUG] streamable_http.py:212 - GET SSE connection established
2025-12-03 02:22:50,148 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'GET']>
2025-12-03 02:22:50,148 [DEBUG] _trace.py:87 - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x10e5c06e0>
2025-12-03 02:22:50,149 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:22:50,149 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:50,149 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:22:50,149 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:50,149 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:22:50,149 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:50,149 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:22:50,149 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:22:50,150 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,153 [DEBUG] server.py:723 - Response sent
2025-12-03 02:22:50,153 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'71a78b76933347b99442de102ea9f3bd'), (b'content-length', b'86075')])
2025-12-03 02:22:50,153 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:50,153 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:22:50,154 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:22:50,154 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:50,154 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:50,154 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='tools/list', params=None, jsonrpc='2.0', id=2)
2025-12-03 02:22:50,154 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'POST']>
2025-12-03 02:22:50,155 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:50,155 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'POST']>
2025-12-03 02:22:50,155 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:50,155 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'POST']>
2025-12-03 02:22:50,155 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:50,155 [INFO] server.py:674 - Processing request of type ListToolsRequest
2025-12-03 02:22:50,155 [DEBUG] server.py:676 - Dispatching request of type ListToolsRequest
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [INFO] middleware.py:152 - Authorized request: Rule unrestricted-access-api-key allowed the action in policy mcp-default-policy | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: python-httpx/0.28.1
2025-12-03 02:22:50,156 [DEBUG] server.py:723 - Response sent
2025-12-03 02:22:50,156 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'71a78b76933347b99442de102ea9f3bd'), (b'content-length', b'3119')])
2025-12-03 02:22:50,157 [INFO] _client.py:1740 - HTTP Request: POST http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:50,157 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'POST']>
2025-12-03 02:22:50,157 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:22:50,157 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:50,157 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:50,158 [DEBUG] _trace.py:87 - send_request_headers.started request=<Request [b'DELETE']>
2025-12-03 02:22:50,158 [DEBUG] _trace.py:87 - send_request_headers.complete
2025-12-03 02:22:50,158 [DEBUG] _trace.py:87 - send_request_body.started request=<Request [b'DELETE']>
2025-12-03 02:22:50,158 [DEBUG] _trace.py:87 - send_request_body.complete
2025-12-03 02:22:50,159 [DEBUG] _trace.py:87 - receive_response_headers.started request=<Request [b'DELETE']>
2025-12-03 02:22:50,159 [DEBUG] streamable_http_manager.py:215 - Session already exists, handling request directly
2025-12-03 02:22:50,159 [INFO] streamable_http.py:646 - Terminating session: 71a78b76933347b99442de102ea9f3bd
2025-12-03 02:22:50,159 [DEBUG] streamable_http.py:597 - Closing standalone SSE writer
2025-12-03 02:22:50,159 [DEBUG] _trace.py:87 - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 02 Dec 2025 23:22:49 GMT'), (b'server', b'uvicorn'), (b'content-type', b'application/json'), (b'mcp-session-id', b'71a78b76933347b99442de102ea9f3bd'), (b'content-length', b'0')])
2025-12-03 02:22:50,159 [INFO] _client.py:1740 - HTTP Request: DELETE http://localhost:8000/mcp "HTTP/1.1 200 OK"
2025-12-03 02:22:50,159 [DEBUG] _trace.py:87 - receive_response_body.started request=<Request [b'DELETE']>
2025-12-03 02:22:50,159 [DEBUG] _trace.py:87 - receive_response_body.complete
2025-12-03 02:22:50,159 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:50,159 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:50,159 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:22:50,159 [DEBUG] sse.py:200 - Got event: http.disconnect. Stop streaming.
2025-12-03 02:22:50,160 [DEBUG] _trace.py:87 - receive_response_body.failed exception=CancelledError("Cancelled via cancel scope 10e600dd0 by <Task pending name='Task-244' coro=<Client._session_runner() running at /Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py:480> cb=[Task.task_wakeup()]>")
2025-12-03 02:22:50,160 [DEBUG] _trace.py:87 - response_closed.started
2025-12-03 02:22:50,160 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:22:50,160 [DEBUG] _trace.py:87 - close.started
2025-12-03 02:22:50,160 [DEBUG] _trace.py:87 - response_closed.complete
2025-12-03 02:22:50,160 [DEBUG] _trace.py:87 - close.complete
2025-12-03 02:22:50,162 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:23:20 +03)" executed successfully
2025-12-03 02:22:58,376 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:22:58.376484+00:00\r\n\r\n'
2025-12-03 02:23:03,985 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:23:03.985593+00:00\r\n\r\n'
2025-12-03 02:23:13,377 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:23:13.377951+00:00\r\n\r\n'
2025-12-03 02:23:18,987 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:23:18.987082+00:00\r\n\r\n'
2025-12-03 02:23:20,126 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:23:20,126 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:23:50.125228+03:00 (in 29.998455 seconds)
2025-12-03 02:23:20,126 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:23:50 +03)" (scheduled at 2025-12-03 02:23:20.125228+03:00)
2025-12-03 02:23:20,126 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:23:20,127 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:23:20,133 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:23:20,133 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:23:20,135 [DEBUG] _trace.py:87 - connect_tcp.failed exception=ConnectError(OSError('All connection attempts failed'))
2025-12-03 02:23:20,135 [ERROR] metadata_scheduler_manager.py:147 - Job failed: Test2 - Client failed to connect: All connection attempts failed
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 481, in _session_runner
    await stack.enter_async_context(self._context_manager())
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 668, in enter_async_context
    result = await _enter(cm)
             ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 353, in _context_manager
    with catch(get_catch_handlers()):
         ~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/exceptiongroup/_catch.py", line 39, in __exit__
    raise unhandled from exc.__cause__
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/exceptiongroup/_catch.py", line 65, in handle_exception
    result = handler(matched)
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/utilities/exceptions.py", line 29, in _exception_handler
    raise leaf
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/client/streamable_http.py", line 409, in handle_request_async
    await self._handle_post_request(ctx)
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/client/streamable_http.py", line 260, in _handle_post_request
    async with ctx.client.stream(
               ~~~~~~~~~~~~~~~~~^
        "POST",
        ^^^^^^^
    ...<2 lines>...
        headers=headers,
        ^^^^^^^^^^^^^^^^
    ) as response:
    ^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1583, in stream
    response = await self.send(
               ^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/src/dbmcp/db/metadata/metadata_scheduler_manager.py", line 124, in execute_job
    async with self._mcp_client:
               ^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 374, in __aenter__
    return await self._connect()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 419, in _connect
    raise RuntimeError(
        f"Client failed to connect: {exception}"
    ) from exception
RuntimeError: Client failed to connect: All connection attempts failed
2025-12-03 02:23:20,140 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:23:50 +03)" executed successfully
2025-12-03 02:23:28,379 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:23:28.379250+00:00\r\n\r\n'
2025-12-03 02:23:33,988 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:23:33.988298+00:00\r\n\r\n'
2025-12-03 02:23:43,380 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:23:43.380394+00:00\r\n\r\n'
2025-12-03 02:23:48,989 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:23:48.989452+00:00\r\n\r\n'
2025-12-03 02:23:50,126 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:23:50,127 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:24:20.125228+03:00 (in 29.998114 seconds)
2025-12-03 02:23:50,127 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:24:20 +03)" (scheduled at 2025-12-03 02:23:50.125228+03:00)
2025-12-03 02:23:50,127 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:23:50,128 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:23:50,139 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:23:50,141 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:23:50,142 [DEBUG] _trace.py:87 - connect_tcp.failed exception=ConnectError(OSError('All connection attempts failed'))
2025-12-03 02:23:50,143 [ERROR] metadata_scheduler_manager.py:147 - Job failed: Test2 - Client failed to connect: All connection attempts failed
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 481, in _session_runner
    await stack.enter_async_context(self._context_manager())
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 668, in enter_async_context
    result = await _enter(cm)
             ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 353, in _context_manager
    with catch(get_catch_handlers()):
         ~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/exceptiongroup/_catch.py", line 39, in __exit__
    raise unhandled from exc.__cause__
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/exceptiongroup/_catch.py", line 65, in handle_exception
    result = handler(matched)
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/utilities/exceptions.py", line 29, in _exception_handler
    raise leaf
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/client/streamable_http.py", line 409, in handle_request_async
    await self._handle_post_request(ctx)
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/client/streamable_http.py", line 260, in _handle_post_request
    async with ctx.client.stream(
               ~~~~~~~~~~~~~~~~~^
        "POST",
        ^^^^^^^
    ...<2 lines>...
        headers=headers,
        ^^^^^^^^^^^^^^^^
    ) as response:
    ^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1583, in stream
    response = await self.send(
               ^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/src/dbmcp/db/metadata/metadata_scheduler_manager.py", line 124, in execute_job
    async with self._mcp_client:
               ^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 374, in __aenter__
    return await self._connect()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 419, in _connect
    raise RuntimeError(
        f"Client failed to connect: {exception}"
    ) from exception
RuntimeError: Client failed to connect: All connection attempts failed
2025-12-03 02:23:50,145 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:24:20 +03)" executed successfully
2025-12-03 02:23:58,383 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:23:58.383226+00:00\r\n\r\n'
2025-12-03 02:24:03,991 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:24:03.991302+00:00\r\n\r\n'
2025-12-03 02:24:13,384 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:24:13.384308+00:00\r\n\r\n'
2025-12-03 02:24:18,992 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:24:18.992692+00:00\r\n\r\n'
2025-12-03 02:24:20,126 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:24:20,126 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:24:50.125228+03:00 (in 29.998583 seconds)
2025-12-03 02:24:20,126 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:24:50 +03)" (scheduled at 2025-12-03 02:24:20.125228+03:00)
2025-12-03 02:24:20,126 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:24:20,128 [DEBUG] streamable_http.py:480 - Connecting to StreamableHTTP endpoint: http://localhost:8000/mcp
2025-12-03 02:24:20,145 [DEBUG] streamable_http.py:389 - Sending client message: root=JSONRPCRequest(method='initialize', params={'protocolVersion': '2025-06-18', 'capabilities': {}, 'clientInfo': {'name': 'mcp', 'version': '0.1.0'}}, jsonrpc='2.0', id=0)
2025-12-03 02:24:20,147 [DEBUG] _trace.py:87 - connect_tcp.started host='localhost' port=8000 local_address=None timeout=30 socket_options=None
2025-12-03 02:24:20,150 [DEBUG] _trace.py:87 - connect_tcp.failed exception=ConnectError(OSError('All connection attempts failed'))
2025-12-03 02:24:20,151 [ERROR] metadata_scheduler_manager.py:147 - Job failed: Test2 - Client failed to connect: All connection attempts failed
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 481, in _session_runner
    await stack.enter_async_context(self._context_manager())
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 668, in enter_async_context
    result = await _enter(cm)
             ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 353, in _context_manager
    with catch(get_catch_handlers()):
         ~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/exceptiongroup/_catch.py", line 39, in __exit__
    raise unhandled from exc.__cause__
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/exceptiongroup/_catch.py", line 65, in handle_exception
    result = handler(matched)
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/utilities/exceptions.py", line 29, in _exception_handler
    raise leaf
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/client/streamable_http.py", line 409, in handle_request_async
    await self._handle_post_request(ctx)
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/mcp/client/streamable_http.py", line 260, in _handle_post_request
    async with ctx.client.stream(
               ~~~~~~~~~~~~~~~~~^
        "POST",
        ^^^^^^^
    ...<2 lines>...
        headers=headers,
        ^^^^^^^^^^^^^^^^
    ) as response:
    ^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 214, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1583, in stream
    response = await self.send(
               ^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 393, in handle_async_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.9_1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/src/dbmcp/db/metadata/metadata_scheduler_manager.py", line 124, in execute_job
    async with self._mcp_client:
               ^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 374, in __aenter__
    return await self._connect()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 419, in _connect
    raise RuntimeError(
        f"Client failed to connect: {exception}"
    ) from exception
RuntimeError: Client failed to connect: All connection attempts failed
2025-12-03 02:24:20,153 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:24:50 +03)" executed successfully
2025-12-03 02:24:28,385 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:24:28.385816+00:00\r\n\r\n'
2025-12-03 02:24:33,994 [DEBUG] sse.py:236 - ping: b': ping - 2025-12-02 23:24:33.994070+00:00\r\n\r\n'
2025-12-03 02:28:18,333 [DEBUG] selector_events.py:64 - Using selector: KqueueSelector
2025-12-03 02:28:18,333 [INFO] main.py:10 - Started
2025-12-03 02:28:18,333 [INFO] mcp_server.py:135 - Starting MCP Database Server...
2025-12-03 02:28:18,333 [DEBUG] server.py:157 - Initializing server 'DBMCPServer ðŸš€'
2025-12-03 02:28:18,333 [DEBUG] server.py:414 - Registering handler for ListToolsRequest
2025-12-03 02:28:18,333 [DEBUG] server.py:281 - Registering handler for ListResourcesRequest
2025-12-03 02:28:18,333 [DEBUG] server.py:301 - Registering handler for ListResourceTemplatesRequest
2025-12-03 02:28:18,333 [DEBUG] server.py:243 - Registering handler for PromptListRequest
2025-12-03 02:28:18,333 [DEBUG] server.py:486 - Registering handler for CallToolRequest
2025-12-03 02:28:18,333 [DEBUG] server.py:316 - Registering handler for ReadResourceRequest
2025-12-03 02:28:18,333 [DEBUG] server.py:265 - Registering handler for GetPromptRequest
2025-12-03 02:28:18,340 [INFO] factory.py:76 - All fetchers initialized
2025-12-03 02:28:18,372 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 5
2025-12-03 02:28:18,401 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 14
2025-12-03 02:28:18,401 [INFO] postgresql_manager.py:33 - Trying to activate connection id: 13
2025-12-03 02:28:18,404 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdarmutlu@localhost:5432/omdb [id=5]
2025-12-03 02:28:18,406 [INFO] postgresql_manager.py:39 - 5 is activated
2025-12-03 02:28:18,429 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: postgres@pg1:5432/demo [id=13]
2025-12-03 02:28:18,431 [INFO] postgresql_manager.py:39 - 13 is activated
2025-12-03 02:28:18,431 [INFO] postgresql_connection.py:45 - ðŸ”— Connected: serdar@pg2:5432/Adventureworks [id=14]
2025-12-03 02:28:18,432 [INFO] postgresql_manager.py:39 - 14 is activated
2025-12-03 02:28:18,432 [INFO] postgresql_manager.py:66 - âœ… DB Manager initialized. Active pools: 3
2025-12-03 02:28:18,433 [INFO] base.py:507 - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-12-03 02:28:18,433 [INFO] metadata_scheduler_manager.py:170 - Loaded job: Test2
2025-12-03 02:28:18,434 [INFO] base.py:1090 - Added job "SchedulerManager.execute_job" to job store "default"
2025-12-03 02:28:18,434 [INFO] base.py:214 - Scheduler started
2025-12-03 02:28:18,434 [INFO] metadata_scheduler_manager.py:175 - Scheduler started
2025-12-03 02:28:18,444 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:28:18,445 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:28:48.433824+03:00 (in 29.988811 seconds)
2025-12-03 02:28:18,445 [INFO] streamable_http_manager.py:110 - StreamableHTTP session manager started
2025-12-03 02:28:48,435 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:28:48,435 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:29:18.433824+03:00 (in 29.997910 seconds)
2025-12-03 02:28:48,436 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:29:18 +03)" (scheduled at 2025-12-03 02:28:48.433824+03:00)
2025-12-03 02:28:48,436 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:28:48,440 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:28:48,440 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:28:48,440 [DEBUG] server.py:456 - Tool cache miss for list-all-tables, refreshing cache
2025-12-03 02:28:48,442 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: undefined
2025-12-03 02:28:48,442 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: undefined
2025-12-03 02:28:48,443 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: undefined
2025-12-03 02:28:48,443 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: undefined
2025-12-03 02:28:48,443 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: undefined
2025-12-03 02:28:48,443 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: undefined
2025-12-03 02:28:48,443 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: undefined
2025-12-03 02:28:48,443 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: undefined
2025-12-03 02:28:48,443 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: undefined
2025-12-03 02:28:48,443 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: undefined
2025-12-03 02:28:48,444 [WARNING] server.py:461 - Tool 'list-all-tables' not listed, no validation will be performed
2025-12-03 02:28:48,444 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: undefined
2025-12-03 02:28:48,445 [DEBUG] server.py:723 - Response sent
2025-12-03 02:28:48,446 [ERROR] metadata_scheduler_manager.py:147 - Job failed: Test2 - Access denied: Action denied by default effect
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/src/dbmcp/db/metadata/metadata_scheduler_manager.py", line 138, in execute_job
    result = await self._mcp_client.call_tool(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 905, in call_tool
    raise ToolError(msg)
fastmcp.exceptions.ToolError: Access denied: Action denied by default effect
2025-12-03 02:28:48,449 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:29:18 +03)" executed successfully
2025-12-03 02:29:18,434 [DEBUG] base.py:1151 - Looking for jobs to run
2025-12-03 02:29:18,435 [DEBUG] base.py:1258 - Next wakeup is due at 2025-12-03 02:29:48.433824+03:00 (in 29.998445 seconds)
2025-12-03 02:29:18,435 [INFO] base.py:179 - Running job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:29:48 +03)" (scheduled at 2025-12-03 02:29:18.433824+03:00)
2025-12-03 02:29:18,436 [INFO] metadata_scheduler_manager.py:121 - Executing scheduled job: Test2
2025-12-03 02:29:18,438 [INFO] server.py:674 - Processing request of type CallToolRequest
2025-12-03 02:29:18,438 [DEBUG] server.py:676 - Dispatching request of type CallToolRequest
2025-12-03 02:29:18,438 [DEBUG] server.py:456 - Tool cache miss for list-all-tables, refreshing cache
2025-12-03 02:29:18,439 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:Add | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:Multiply | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:list_all_connections_details | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:get_connection_detail | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:list-all-tables-in-schema | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:list-all-columns-in-table | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:check-bloat | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:database-size | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/list | MCP uri: mcp:tools:query | User-Agent: undefined
2025-12-03 02:29:18,440 [WARNING] server.py:461 - Tool 'list-all-tables' not listed, no validation will be performed
2025-12-03 02:29:18,440 [WARNING] middleware.py:150 - Authorization violation: Action denied by default effect | MCP method: tools/call | MCP uri: mcp:tools:list-all-tables | User-Agent: undefined
2025-12-03 02:29:18,441 [DEBUG] server.py:723 - Response sent
2025-12-03 02:29:18,441 [ERROR] metadata_scheduler_manager.py:147 - Job failed: Test2 - Access denied: Action denied by default effect
Traceback (most recent call last):
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/src/dbmcp/db/metadata/metadata_scheduler_manager.py", line 138, in execute_job
    result = await self._mcp_client.call_tool(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
    )
    ^
  File "/Users/serdarmutlu/Projects/mcp/python/DBMCPServer/.venv/lib/python3.13/site-packages/fastmcp/client/client.py", line 905, in call_tool
    raise ToolError(msg)
fastmcp.exceptions.ToolError: Access denied: Action denied by default effect
2025-12-03 02:29:18,442 [INFO] base.py:203 - Job "SchedulerManager.execute_job (trigger: interval[0:00:30], next run at: 2025-12-03 02:29:48 +03)" executed successfully
2025-12-03 02:29:21,536 [INFO] streamable_http_manager.py:114 - StreamableHTTP session manager shutting down
